

  0%|▎                                                                                                                             | 1/500 [00:04<40:02,  4.82s/it]

  0%|▌                                                                                                                             | 2/500 [00:09<37:52,  4.56s/it]

  1%|▊                                                                                                                             | 3/500 [00:13<37:02,  4.47s/it]

  1%|█                                                                                                                             | 4/500 [00:18<38:08,  4.61s/it]

  1%|█▎                                                                                                                            | 5/500 [00:22<37:33,  4.55s/it]

  1%|█▌                                                                                                                            | 6/500 [00:28<41:14,  5.01s/it]

  1%|█▊                                                                                                                            | 7/500 [00:33<40:01,  4.87s/it]

  2%|██                                                                                                                            | 8/500 [00:37<38:49,  4.74s/it]
{'loss': 2.0968, 'grad_norm': 2.0635111331939697, 'learning_rate': 9.647490524827834e-05, 'epoch': 0.0}


  2%|██▌                                                                                                                          | 10/500 [00:46<37:03,  4.54s/it]
{'loss': 1.7956, 'grad_norm': 2.2170939445495605, 'learning_rate': 9.379104766746722e-05, 'epoch': 0.0}


  2%|███                                                                                                                          | 12/500 [00:56<38:32,  4.74s/it]

  3%|███▎                                                                                                                         | 13/500 [01:00<36:58,  4.56s/it]

  3%|███▌                                                                                                                         | 14/500 [01:04<35:50,  4.43s/it]

  3%|███▊                                                                                                                         | 15/500 [01:08<35:03,  4.34s/it]

  3%|████                                                                                                                         | 16/500 [01:13<34:29,  4.28s/it]

  3%|████▎                                                                                                                        | 17/500 [01:17<33:58,  4.22s/it]

  4%|████▌                                                                                                                        | 18/500 [01:21<33:32,  4.18s/it]

  4%|████▊                                                                                                                        | 19/500 [01:25<33:19,  4.16s/it]

  4%|█████                                                                                                                        | 20/500 [01:29<33:11,  4.15s/it]
{'loss': 1.3577, 'grad_norm': 2.9167375564575195, 'learning_rate': 7.118637138014396e-05, 'epoch': 0.0}

  4%|█████▎                                                                                                                       | 21/500 [01:34<34:23,  4.31s/it]

  4%|█████▌                                                                                                                       | 22/500 [01:38<33:49,  4.25s/it]


  5%|██████                                                                                                                       | 24/500 [01:46<33:08,  4.18s/it]

  5%|██████▎                                                                                                                      | 25/500 [01:50<32:53,  4.15s/it]

  5%|██████▌                                                                                                                      | 26/500 [01:54<32:38,  4.13s/it]

  5%|██████▊                                                                                                                      | 27/500 [01:58<32:30,  4.12s/it]

  6%|███████                                                                                                                      | 28/500 [02:02<32:17,  4.11s/it]

  6%|███████▎                                                                                                                     | 29/500 [02:06<32:12,  4.10s/it]

  6%|███████▌                                                                                                                     | 30/500 [02:11<32:05,  4.10s/it]

  6%|███████▊                                                                                                                     | 31/500 [02:15<33:23,  4.27s/it]

  6%|████████                                                                                                                     | 32/500 [02:19<32:51,  4.21s/it]

  7%|████████▎                                                                                                                    | 33/500 [02:23<32:29,  4.18s/it]

  7%|████████▌                                                                                                                    | 34/500 [02:27<32:09,  4.14s/it]

  7%|████████▊                                                                                                                    | 35/500 [02:32<31:58,  4.12s/it]
{'loss': 1.0007, 'grad_norm': 3.3600270748138428, 'learning_rate': 2.5730462731464273e-05, 'epoch': 0.0}

  7%|█████████                                                                                                                    | 36/500 [02:36<31:47,  4.11s/it]

  7%|█████████▎                                                                                                                   | 37/500 [02:40<31:38,  4.10s/it]

  8%|█████████▌                                                                                                                   | 38/500 [02:44<31:31,  4.10s/it]

  8%|█████████▊                                                                                                                   | 39/500 [02:48<31:07,  4.05s/it]


  8%|██████████▎                                                                                                                  | 41/500 [02:56<32:11,  4.21s/it]

  8%|██████████▌                                                                                                                  | 42/500 [03:00<31:39,  4.15s/it]

  9%|██████████▊                                                                                                                  | 43/500 [03:04<31:07,  4.09s/it]

  9%|███████████                                                                                                                  | 44/500 [03:08<30:51,  4.06s/it]

  9%|███████████▎                                                                                                                 | 45/500 [03:12<30:48,  4.06s/it]

  9%|███████████▌                                                                                                                 | 46/500 [03:16<30:33,  4.04s/it]

  9%|███████████▊                                                                                                                 | 47/500 [03:20<30:20,  4.02s/it]

 10%|████████████                                                                                                                 | 48/500 [03:24<30:06,  4.00s/it]

 10%|████████████▎                                                                                                                | 49/500 [03:28<29:52,  3.97s/it]

 10%|████████████▌                                                                                                                | 50/500 [03:32<29:43,  3.96s/it]

 10%|████████████▊                                                                                                                | 51/500 [03:37<32:13,  4.31s/it]

 10%|█████████████                                                                                                                | 52/500 [03:42<32:08,  4.30s/it]
{'loss': 1.2889, 'grad_norm': 2.3827123641967773, 'learning_rate': 9.999900908311602e-05, 'epoch': 0.0}


 11%|█████████████▌                                                                                                               | 54/500 [03:50<32:01,  4.31s/it]

 11%|█████████████▊                                                                                                               | 55/500 [03:54<31:49,  4.29s/it]

 11%|██████████████                                                                                                               | 56/500 [04:00<35:45,  4.83s/it]

 11%|██████████████▎                                                                                                              | 57/500 [04:06<36:13,  4.91s/it]
{'loss': 1.3009, 'grad_norm': 2.331167697906494, 'learning_rate': 9.744468373277797e-05, 'epoch': 0.0}


 12%|██████████████▊                                                                                                              | 59/500 [04:14<33:55,  4.61s/it]

 12%|███████████████                                                                                                              | 60/500 [04:19<33:21,  4.55s/it]
{'loss': 1.2061, 'grad_norm': 2.097308397293091, 'learning_rate': 9.363825232865413e-05, 'epoch': 0.0}


 12%|███████████████▌                                                                                                             | 62/500 [04:28<33:44,  4.62s/it]

 13%|███████████████▊                                                                                                             | 63/500 [04:32<32:59,  4.53s/it]

 13%|████████████████                                                                                                             | 64/500 [04:37<32:23,  4.46s/it]
{'loss': 1.1975, 'grad_norm': 2.572021007537842, 'learning_rate': 8.618011854451056e-05, 'epoch': 0.01}


 13%|████████████████▌                                                                                                            | 66/500 [04:51<41:58,  5.80s/it]

 13%|████████████████▊                                                                                                            | 67/500 [04:57<41:25,  5.74s/it]

 14%|█████████████████                                                                                                            | 68/500 [05:01<38:29,  5.34s/it]

 14%|█████████████████▎                                                                                                           | 69/500 [05:05<36:19,  5.06s/it]
{'loss': 1.2781, 'grad_norm': 2.283553123474121, 'learning_rate': 7.371718981393815e-05, 'epoch': 0.01}


 14%|█████████████████▊                                                                                                           | 71/500 [05:15<35:52,  5.02s/it]

 14%|██████████████████                                                                                                           | 72/500 [05:19<34:02,  4.77s/it]

 15%|██████████████████▎                                                                                                          | 73/500 [05:24<32:46,  4.61s/it]
{'loss': 1.1853, 'grad_norm': 2.0953032970428467, 'learning_rate': 6.200104639843982e-05, 'epoch': 0.01}


 15%|██████████████████▊                                                                                                          | 75/500 [05:32<31:45,  4.48s/it]

 15%|███████████████████                                                                                                          | 76/500 [05:36<30:57,  4.38s/it]

 15%|███████████████████▎                                                                                                         | 77/500 [05:41<30:24,  4.31s/it]

 16%|███████████████████▌                                                                                                         | 78/500 [05:45<29:59,  4.26s/it]

 16%|███████████████████▊                                                                                                         | 79/500 [05:49<29:37,  4.22s/it]

 16%|████████████████████                                                                                                         | 80/500 [05:53<29:31,  4.22s/it]

 16%|████████████████████▎                                                                                                        | 81/500 [05:58<31:32,  4.52s/it]

 16%|████████████████████▌                                                                                                        | 82/500 [06:02<30:43,  4.41s/it]

 17%|████████████████████▊                                                                                                        | 83/500 [06:07<30:02,  4.32s/it]

 17%|█████████████████████                                                                                                        | 84/500 [06:11<29:35,  4.27s/it]

 17%|█████████████████████▎                                                                                                       | 85/500 [06:15<29:12,  4.22s/it]

 17%|█████████████████████▌                                                                                                       | 86/500 [06:19<28:54,  4.19s/it]

 17%|█████████████████████▊                                                                                                       | 87/500 [06:23<28:38,  4.16s/it]

 18%|██████████████████████                                                                                                       | 88/500 [06:27<28:35,  4.16s/it]

 18%|██████████████████████▎                                                                                                      | 89/500 [06:32<29:04,  4.24s/it]
{'loss': 0.9146, 'grad_norm': 2.7812325954437256, 'learning_rate': 1.5375426513331636e-05, 'epoch': 0.01}


 18%|██████████████████████▊                                                                                                      | 91/500 [06:41<29:47,  4.37s/it]

 18%|███████████████████████                                                                                                      | 92/500 [06:45<28:53,  4.25s/it]

 19%|███████████████████████▎                                                                                                     | 93/500 [06:49<28:16,  4.17s/it]

 19%|███████████████████████▌                                                                                                     | 94/500 [06:53<28:03,  4.15s/it]

 19%|███████████████████████▊                                                                                                     | 95/500 [06:57<28:09,  4.17s/it]

 19%|████████████████████████                                                                                                     | 96/500 [07:01<28:53,  4.29s/it]
{'loss': 0.8532, 'grad_norm': 4.781639099121094, 'learning_rate': 3.296579894209356e-06, 'epoch': 0.01}


 20%|████████████████████████▌                                                                                                    | 98/500 [07:12<31:31,  4.71s/it]
{'loss': 0.7204, 'grad_norm': 3.131596088409424, 'learning_rate': 1.42407690590754e-06, 'epoch': 0.01}


 20%|████████████████████████▊                                                                                                   | 100/500 [07:21<31:16,  4.69s/it]

 20%|█████████████████████████                                                                                                   | 101/500 [07:27<33:32,  5.04s/it]
{'loss': 1.397, 'grad_norm': 2.771995782852173, 'learning_rate': 6.340548466648443e-08, 'epoch': 0.01}


 21%|█████████████████████████▌                                                                                                  | 103/500 [07:37<33:10,  5.01s/it]

 21%|█████████████████████████▊                                                                                                  | 104/500 [07:41<32:04,  4.86s/it]

 21%|██████████████████████████                                                                                                  | 105/500 [07:46<31:34,  4.80s/it]

 21%|██████████████████████████▎                                                                                                 | 106/500 [07:52<33:35,  5.12s/it]

 21%|██████████████████████████▌                                                                                                 | 107/500 [07:58<34:43,  5.30s/it]

 22%|██████████████████████████▊                                                                                                 | 108/500 [08:03<34:25,  5.27s/it]

 22%|███████████████████████████                                                                                                 | 109/500 [08:08<33:35,  5.15s/it]
{'loss': 1.4243, 'grad_norm': 2.2244791984558105, 'learning_rate': 9.495042982033609e-05, 'epoch': 0.01}


 22%|███████████████████████████▌                                                                                                | 111/500 [08:18<33:08,  5.11s/it]
{'loss': 1.2872, 'grad_norm': 2.6673929691314697, 'learning_rate': 9.184472612395842e-05, 'epoch': 0.01}


 23%|████████████████████████████                                                                                                | 113/500 [08:26<30:42,  4.76s/it]

 23%|████████████████████████████▎                                                                                               | 114/500 [08:31<29:42,  4.62s/it]

 23%|████████████████████████████▌                                                                                               | 115/500 [08:35<28:43,  4.48s/it]

 23%|████████████████████████████▊                                                                                               | 116/500 [08:39<27:57,  4.37s/it]

 23%|█████████████████████████████                                                                                               | 117/500 [08:44<28:36,  4.48s/it]

 24%|█████████████████████████████▎                                                                                              | 118/500 [08:48<28:00,  4.40s/it]

 24%|█████████████████████████████▌                                                                                              | 119/500 [08:52<28:12,  4.44s/it]

 24%|█████████████████████████████▊                                                                                              | 120/500 [08:58<30:08,  4.76s/it]

 24%|██████████████████████████████                                                                                              | 121/500 [09:03<31:25,  4.97s/it]

 24%|██████████████████████████████▎                                                                                             | 122/500 [09:08<30:25,  4.83s/it]
{'loss': 1.3498, 'grad_norm': 2.520561456680298, 'learning_rate': 6.473059656313786e-05, 'epoch': 0.01}


 25%|██████████████████████████████▊                                                                                             | 124/500 [09:19<32:27,  5.18s/it]
{'loss': 0.9887, 'grad_norm': 2.8503761291503906, 'learning_rate': 5.8613510076644384e-05, 'epoch': 0.01}


 25%|███████████████████████████████▏                                                                                            | 126/500 [09:29<32:06,  5.15s/it]

 25%|███████████████████████████████▍                                                                                            | 127/500 [09:34<30:58,  4.98s/it]

 26%|███████████████████████████████▋                                                                                            | 128/500 [09:38<29:35,  4.77s/it]
{'loss': 0.9239, 'grad_norm': 4.0476813316345215, 'learning_rate': 4.606919980087942e-05, 'epoch': 0.01}


 26%|████████████████████████████████▏                                                                                           | 130/500 [09:47<28:16,  4.58s/it]

 26%|████████████████████████████████▍                                                                                           | 131/500 [09:52<28:47,  4.68s/it]

 26%|████████████████████████████████▋                                                                                           | 132/500 [09:56<27:50,  4.54s/it]
{'loss': 1.0658, 'grad_norm': 2.973689317703247, 'learning_rate': 3.3772861834003287e-05, 'epoch': 0.01}


 27%|█████████████████████████████████▏                                                                                          | 134/500 [10:05<27:18,  4.48s/it]

 27%|█████████████████████████████████▍                                                                                          | 135/500 [10:09<26:33,  4.37s/it]

 27%|█████████████████████████████████▋                                                                                          | 136/500 [10:13<25:53,  4.27s/it]

 27%|█████████████████████████████████▉                                                                                          | 137/500 [10:17<25:32,  4.22s/it]

 28%|██████████████████████████████████▏                                                                                         | 138/500 [10:21<25:06,  4.16s/it]

 28%|██████████████████████████████████▍                                                                                         | 139/500 [10:25<24:40,  4.10s/it]

 28%|██████████████████████████████████▋                                                                                         | 140/500 [10:29<24:19,  4.05s/it]

 28%|██████████████████████████████████▉                                                                                         | 141/500 [10:33<25:15,  4.22s/it]

 28%|███████████████████████████████████▏                                                                                        | 142/500 [10:37<24:40,  4.13s/it]

 29%|███████████████████████████████████▍                                                                                        | 143/500 [10:41<24:18,  4.08s/it]

 29%|███████████████████████████████████▋                                                                                        | 144/500 [10:45<24:08,  4.07s/it]

 29%|███████████████████████████████████▉                                                                                        | 145/500 [10:50<24:11,  4.09s/it]
{'loss': 0.7392, 'grad_norm': 2.74967885017395, 'learning_rate': 4.382674381972224e-06, 'epoch': 0.01}


 29%|████████████████████████████████████▍                                                                                       | 147/500 [10:59<25:56,  4.41s/it]

 30%|████████████████████████████████████▋                                                                                       | 148/500 [11:03<26:02,  4.44s/it]
{'loss': 0.6697, 'grad_norm': 4.108006954193115, 'learning_rate': 1.3504465085626528e-06, 'epoch': 0.01}

 30%|████████████████████████████████████▉                                                                                       | 149/500 [11:08<25:33,  4.37s/it]


 30%|█████████████████████████████████████▍                                                                                      | 151/500 [11:17<26:31,  4.56s/it]

 30%|█████████████████████████████████████▋                                                                                      | 152/500 [11:21<26:13,  4.52s/it]
{'loss': 1.2659, 'grad_norm': 2.48502254486084, 'learning_rate': 9.999108198370249e-05, 'epoch': 0.01}


 31%|██████████████████████████████████████▏                                                                                     | 154/500 [11:31<27:05,  4.70s/it]
{'loss': 1.1643, 'grad_norm': 2.202578544616699, 'learning_rate': 9.947671853780054e-05, 'epoch': 0.01}

 31%|██████████████████████████████████████▍                                                                                     | 155/500 [11:38<30:49,  5.36s/it]


 31%|██████████████████████████████████████▉                                                                                     | 157/500 [11:49<31:21,  5.49s/it]
{'loss': 1.2382, 'grad_norm': 2.2603063583374023, 'learning_rate': 9.724223576279395e-05, 'epoch': 0.01}

 32%|███████████████████████████████████████▏                                                                                    | 158/500 [11:54<29:33,  5.19s/it]

 32%|███████████████████████████████████████▍                                                                                    | 159/500 [11:58<27:52,  4.91s/it]


 32%|███████████████████████████████████████▉                                                                                    | 161/500 [12:07<27:01,  4.78s/it]

 32%|████████████████████████████████████████▏                                                                                   | 162/500 [12:11<26:00,  4.62s/it]

 33%|████████████████████████████████████████▍                                                                                   | 163/500 [12:16<25:05,  4.47s/it]
{'loss': 1.1009, 'grad_norm': 2.5349082946777344, 'learning_rate': 8.787168446125638e-05, 'epoch': 0.01}

 33%|████████████████████████████████████████▋                                                                                   | 164/500 [12:20<24:30,  4.38s/it]


 33%|█████████████████████████████████████████▏                                                                                  | 166/500 [12:28<23:53,  4.29s/it]

 33%|█████████████████████████████████████████▍                                                                                  | 167/500 [12:32<23:37,  4.26s/it]

 34%|█████████████████████████████████████████▋                                                                                  | 168/500 [12:37<24:29,  4.43s/it]
{'loss': 1.2547, 'grad_norm': 2.6040496826171875, 'learning_rate': 7.590314550668051e-05, 'epoch': 0.01}


 34%|██████████████████████████████████████████▏                                                                                 | 170/500 [12:46<24:57,  4.54s/it]
{'loss': 1.1467, 'grad_norm': 2.7698814868927, 'learning_rate': 7.032724590877824e-05, 'epoch': 0.01}


 34%|██████████████████████████████████████████▋                                                                                 | 172/500 [12:57<26:24,  4.83s/it]

 35%|██████████████████████████████████████████▉                                                                                 | 173/500 [13:03<27:53,  5.12s/it]
{'loss': 0.9955, 'grad_norm': 2.4111437797546387, 'learning_rate': 6.13889375035821e-05, 'epoch': 0.01}


 35%|███████████████████████████████████████████▍                                                                                | 175/500 [13:15<30:48,  5.69s/it]

 35%|███████████████████████████████████████████▋                                                                                | 176/500 [13:20<29:25,  5.45s/it]

 35%|███████████████████████████████████████████▉                                                                                | 177/500 [13:25<27:32,  5.12s/it]

 36%|████████████████████████████████████████████▏                                                                               | 178/500 [13:29<26:02,  4.85s/it]

 36%|████████████████████████████████████████████▍                                                                               | 179/500 [13:33<24:59,  4.67s/it]

 36%|████████████████████████████████████████████▋                                                                               | 180/500 [13:37<24:10,  4.53s/it]

 36%|████████████████████████████████████████████▉                                                                               | 181/500 [13:42<24:44,  4.65s/it]

 36%|█████████████████████████████████████████████▏                                                                              | 182/500 [13:46<23:54,  4.51s/it]

 37%|█████████████████████████████████████████████▍                                                                              | 183/500 [13:51<23:21,  4.42s/it]

 37%|█████████████████████████████████████████████▋                                                                              | 184/500 [13:55<23:01,  4.37s/it]

 37%|█████████████████████████████████████████████▉                                                                              | 185/500 [13:59<22:40,  4.32s/it]

 37%|██████████████████████████████████████████████▏                                                                             | 186/500 [14:03<22:25,  4.29s/it]

 37%|██████████████████████████████████████████████▍                                                                             | 187/500 [14:08<22:13,  4.26s/it]

 38%|██████████████████████████████████████████████▌                                                                             | 188/500 [14:12<22:12,  4.27s/it]

 38%|██████████████████████████████████████████████▊                                                                             | 189/500 [14:16<22:21,  4.31s/it]

 38%|███████████████████████████████████████████████                                                                             | 190/500 [14:21<22:24,  4.34s/it]

 38%|███████████████████████████████████████████████▎                                                                            | 191/500 [14:26<23:38,  4.59s/it]
{'loss': 0.875, 'grad_norm': 2.830258846282959, 'learning_rate': 1.0726846405303754e-05, 'epoch': 0.02}

 38%|███████████████████████████████████████████████▌                                                                            | 192/500 [14:30<22:52,  4.46s/it]


 39%|████████████████████████████████████████████████                                                                            | 194/500 [14:39<22:23,  4.39s/it]

 39%|████████████████████████████████████████████████▎                                                                           | 195/500 [14:43<22:31,  4.43s/it]

 39%|████████████████████████████████████████████████▌                                                                           | 196/500 [14:47<22:21,  4.41s/it]

 39%|████████████████████████████████████████████████▊                                                                           | 197/500 [14:52<21:59,  4.36s/it]
{'loss': 0.6067, 'grad_norm': 3.0584912300109863, 'learning_rate': 2.082172909250568e-06, 'epoch': 0.02}


 40%|█████████████████████████████████████████████████▎                                                                          | 199/500 [15:01<22:24,  4.47s/it]

 40%|█████████████████████████████████████████████████▌                                                                          | 200/500 [15:05<21:55,  4.38s/it]

 40%|█████████████████████████████████████████████████▊                                                                          | 201/500 [15:10<23:34,  4.73s/it]

 40%|██████████████████████████████████████████████████                                                                          | 202/500 [15:15<22:52,  4.60s/it]

 41%|██████████████████████████████████████████████████▎                                                                         | 203/500 [15:20<24:22,  4.93s/it]
{'loss': 1.0876, 'grad_norm': 2.8092005252838135, 'learning_rate': 9.980590535514233e-05, 'epoch': 0.02}


 41%|██████████████████████████████████████████████████▊                                                                         | 205/500 [15:31<25:19,  5.15s/it]
{'loss': 1.3142, 'grad_norm': 2.450028657913208, 'learning_rate': 9.885886355253758e-05, 'epoch': 0.02}


 41%|███████████████████████████████████████████████████▎                                                                        | 207/500 [15:40<23:30,  4.81s/it]

 42%|███████████████████████████████████████████████████▌                                                                        | 208/500 [15:45<22:33,  4.63s/it]

 42%|███████████████████████████████████████████████████▊                                                                        | 209/500 [15:49<21:53,  4.51s/it]

 42%|████████████████████████████████████████████████████                                                                        | 210/500 [15:53<21:27,  4.44s/it]

 42%|████████████████████████████████████████████████████▎                                                                       | 211/500 [15:58<21:56,  4.56s/it]

 42%|████████████████████████████████████████████████████▌                                                                       | 212/500 [16:02<21:14,  4.42s/it]
{'loss': 1.2525, 'grad_norm': 2.234113931655884, 'learning_rate': 8.965968101206296e-05, 'epoch': 0.02}

 43%|████████████████████████████████████████████████████▊                                                                       | 213/500 [16:06<20:43,  4.33s/it]


 43%|█████████████████████████████████████████████████████▎                                                                      | 215/500 [16:14<20:04,  4.23s/it]

 43%|█████████████████████████████████████████████████████▌                                                                      | 216/500 [16:19<19:50,  4.19s/it]

 43%|█████████████████████████████████████████████████████▊                                                                      | 217/500 [16:23<19:50,  4.21s/it]

 44%|██████████████████████████████████████████████████████                                                                      | 218/500 [16:27<19:36,  4.17s/it]

 44%|██████████████████████████████████████████████████████▎                                                                     | 219/500 [16:31<19:28,  4.16s/it]

 44%|██████████████████████████████████████████████████████▌                                                                     | 220/500 [16:35<19:20,  4.14s/it]

 44%|██████████████████████████████████████████████████████▊                                                                     | 221/500 [16:40<20:06,  4.32s/it]

 44%|███████████████████████████████████████████████████████                                                                     | 222/500 [16:44<19:45,  4.26s/it]

 45%|███████████████████████████████████████████████████████▎                                                                    | 223/500 [16:48<19:28,  4.22s/it]
{'loss': 1.0805, 'grad_norm': 2.595392942428589, 'learning_rate': 6.108219985664158e-05, 'epoch': 0.02}

 45%|███████████████████████████████████████████████████████▌                                                                    | 224/500 [16:52<19:16,  4.19s/it]


 45%|████████████████████████████████████████████████████████                                                                    | 226/500 [17:00<18:56,  4.15s/it]

 45%|████████████████████████████████████████████████████████▎                                                                   | 227/500 [17:05<18:48,  4.13s/it]

 46%|████████████████████████████████████████████████████████▌                                                                   | 228/500 [17:09<18:44,  4.14s/it]

 46%|████████████████████████████████████████████████████████▊                                                                   | 229/500 [17:13<18:43,  4.14s/it]
{'loss': 0.9194, 'grad_norm': 2.7798476219177246, 'learning_rate': 4.2318218922662114e-05, 'epoch': 0.02}

 46%|█████████████████████████████████████████████████████████                                                                   | 230/500 [17:18<20:27,  4.55s/it]


 46%|█████████████████████████████████████████████████████████▌                                                                  | 232/500 [17:31<25:04,  5.61s/it]

 47%|█████████████████████████████████████████████████████████▊                                                                  | 233/500 [17:37<24:30,  5.51s/it]

 47%|██████████████████████████████████████████████████████████                                                                  | 234/500 [17:43<25:40,  5.79s/it]

 47%|██████████████████████████████████████████████████████████▎                                                                 | 235/500 [17:49<25:17,  5.73s/it]

 47%|██████████████████████████████████████████████████████████▌                                                                 | 236/500 [17:53<23:16,  5.29s/it]

 47%|██████████████████████████████████████████████████████████▊                                                                 | 237/500 [17:57<21:42,  4.95s/it]

 48%|███████████████████████████████████████████████████████████                                                                 | 238/500 [18:01<20:24,  4.67s/it]

 48%|███████████████████████████████████████████████████████████▎                                                                | 239/500 [18:05<19:26,  4.47s/it]

 48%|███████████████████████████████████████████████████████████▌                                                                | 240/500 [18:10<20:04,  4.63s/it]

 48%|███████████████████████████████████████████████████████████▊                                                                | 241/500 [18:16<21:00,  4.87s/it]
{'loss': 0.7911, 'grad_norm': 3.1857683658599854, 'learning_rate': 1.0532800522333897e-05, 'epoch': 0.02}

 48%|████████████████████████████████████████████████████████████                                                                | 242/500 [18:20<20:39,  4.80s/it]


 49%|████████████████████████████████████████████████████████████▌                                                               | 244/500 [18:29<19:06,  4.48s/it]

 49%|████████████████████████████████████████████████████████████▊                                                               | 245/500 [18:33<18:43,  4.41s/it]

 49%|█████████████████████████████████████████████████████████████                                                               | 246/500 [18:37<18:11,  4.30s/it]

 49%|█████████████████████████████████████████████████████████████▎                                                              | 247/500 [18:41<17:55,  4.25s/it]

 50%|█████████████████████████████████████████████████████████████▌                                                              | 248/500 [18:45<17:35,  4.19s/it]

 50%|█████████████████████████████████████████████████████████████▊                                                              | 249/500 [18:49<17:26,  4.17s/it]

 50%|██████████████████████████████████████████████████████████████                                                              | 250/500 [18:54<17:52,  4.29s/it]

 50%|██████████████████████████████████████████████████████████████▏                                                             | 251/500 [18:59<19:02,  4.59s/it]

 50%|██████████████████████████████████████████████████████████████▍                                                             | 252/500 [19:03<18:49,  4.56s/it]

 51%|██████████████████████████████████████████████████████████████▋                                                             | 253/500 [19:08<18:35,  4.52s/it]
{'loss': 1.2725, 'grad_norm': 2.809828758239746, 'learning_rate': 9.997522904167844e-05, 'epoch': 0.02}


 51%|███████████████████████████████████████████████████████████████▏                                                            | 255/500 [19:17<18:12,  4.46s/it]

 51%|███████████████████████████████████████████████████████████████▍                                                            | 256/500 [19:21<18:23,  4.52s/it]
{'loss': 1.1981, 'grad_norm': 2.195054769515991, 'learning_rate': 9.879102652442027e-05, 'epoch': 0.02}


 52%|███████████████████████████████████████████████████████████████▉                                                            | 258/500 [19:31<18:30,  4.59s/it]

 52%|████████████████████████████████████████████████████████████████▏                                                           | 259/500 [19:35<18:31,  4.61s/it]

 52%|████████████████████████████████████████████████████████████████▍                                                           | 260/500 [19:40<18:02,  4.51s/it]

 52%|████████████████████████████████████████████████████████████████▋                                                           | 261/500 [19:45<18:23,  4.62s/it]

 52%|████████████████████████████████████████████████████████████████▉                                                           | 262/500 [19:50<19:23,  4.89s/it]
{'loss': 1.2486, 'grad_norm': 2.5761420726776123, 'learning_rate': 9.132038099576292e-05, 'epoch': 0.02}


 53%|█████████████████████████████████████████████████████████████████▍                                                          | 264/500 [20:02<21:18,  5.42s/it]

 53%|█████████████████████████████████████████████████████████████████▋                                                          | 265/500 [20:07<20:27,  5.23s/it]

 53%|█████████████████████████████████████████████████████████████████▉                                                          | 266/500 [20:11<19:38,  5.03s/it]

 53%|██████████████████████████████████████████████████████████████████▏                                                         | 267/500 [20:16<18:59,  4.89s/it]

 54%|██████████████████████████████████████████████████████████████████▍                                                         | 268/500 [20:21<19:37,  5.07s/it]

 54%|██████████████████████████████████████████████████████████████████▋                                                         | 269/500 [20:26<19:04,  4.95s/it]

 54%|██████████████████████████████████████████████████████████████████▉                                                         | 270/500 [20:31<18:59,  4.96s/it]
{'loss': 1.1755, 'grad_norm': 2.5262885093688965, 'learning_rate': 7.260130233805741e-05, 'epoch': 0.02}


 54%|███████████████████████████████████████████████████████████████████▍                                                        | 272/500 [20:41<18:53,  4.97s/it]
{'loss': 1.2444, 'grad_norm': 2.190485715866089, 'learning_rate': 6.682133535433403e-05, 'epoch': 0.02}


 55%|███████████████████████████████████████████████████████████████████▉                                                        | 274/500 [20:51<18:41,  4.96s/it]

 55%|████████████████████████████████████████████████████████████████████▏                                                       | 275/500 [20:56<18:19,  4.89s/it]

 55%|████████████████████████████████████████████████████████████████████▍                                                       | 276/500 [21:01<18:23,  4.93s/it]

 55%|████████████████████████████████████████████████████████████████████▋                                                       | 277/500 [21:06<18:04,  4.86s/it]
{'loss': 0.9694, 'grad_norm': 2.9938695430755615, 'learning_rate': 5.1416360303462254e-05, 'epoch': 0.02}

 56%|████████████████████████████████████████████████████████████████████▉                                                       | 278/500 [21:10<17:21,  4.69s/it]

 56%|█████████████████████████████████████████████████████████████████████▏                                                      | 279/500 [21:14<16:37,  4.52s/it]


 56%|█████████████████████████████████████████████████████████████████████▋                                                      | 281/500 [21:23<16:24,  4.50s/it]

 56%|█████████████████████████████████████████████████████████████████████▉                                                      | 282/500 [21:27<15:53,  4.38s/it]

 57%|██████████████████████████████████████████████████████████████████████▏                                                     | 283/500 [21:31<15:30,  4.29s/it]

 57%|██████████████████████████████████████████████████████████████████████▍                                                     | 284/500 [21:35<15:12,  4.22s/it]

 57%|██████████████████████████████████████████████████████████████████████▋                                                     | 285/500 [21:39<14:58,  4.18s/it]

 57%|██████████████████████████████████████████████████████████████████████▉                                                     | 286/500 [21:43<14:47,  4.15s/it]
{'loss': 0.8315, 'grad_norm': 2.9398815631866455, 'learning_rate': 2.4366618353179644e-05, 'epoch': 0.02}

 57%|███████████████████████████████████████████████████████████████████████▏                                                    | 287/500 [21:48<15:18,  4.31s/it]


 58%|███████████████████████████████████████████████████████████████████████▋                                                    | 289/500 [21:57<15:42,  4.47s/it]

 58%|███████████████████████████████████████████████████████████████████████▉                                                    | 290/500 [22:02<15:31,  4.44s/it]
{'loss': 0.8949, 'grad_norm': 2.702108383178711, 'learning_rate': 1.4478113702197539e-05, 'epoch': 0.02}


 58%|████████████████████████████████████████████████████████████████████████▍                                                   | 292/500 [22:11<15:30,  4.48s/it]

 59%|████████████████████████████████████████████████████████████████████████▋                                                   | 293/500 [22:15<15:00,  4.35s/it]

 59%|████████████████████████████████████████████████████████████████████████▉                                                   | 294/500 [22:19<14:38,  4.27s/it]

 59%|█████████████████████████████████████████████████████████████████████████▏                                                  | 295/500 [22:23<14:33,  4.26s/it]
{'loss': 0.6924, 'grad_norm': 3.5429203510284424, 'learning_rate': 5.328837803351044e-06, 'epoch': 0.02}

 59%|█████████████████████████████████████████████████████████████████████████▍                                                  | 296/500 [22:28<15:12,  4.47s/it]


 60%|█████████████████████████████████████████████████████████████████████████▉                                                  | 298/500 [22:37<14:52,  4.42s/it]

 60%|██████████████████████████████████████████████████████████████████████████▏                                                 | 299/500 [22:42<15:15,  4.55s/it]
{'loss': 0.7239, 'grad_norm': 3.2983977794647217, 'learning_rate': 1.1411364474624043e-06, 'epoch': 0.02}


 60%|██████████████████████████████████████████████████████████████████████████▋                                                 | 301/500 [22:52<16:16,  4.91s/it]
{'loss': 1.2456, 'grad_norm': 2.305128335952759, 'learning_rate': 1.9409464485766194e-07, 'epoch': 0.02}

 60%|██████████████████████████████████████████████████████████████████████████▉                                                 | 302/500 [22:56<15:34,  4.72s/it]


 61%|███████████████████████████████████████████████████████████████████████████▍                                                | 304/500 [23:05<14:47,  4.53s/it]

 61%|███████████████████████████████████████████████████████████████████████████▋                                                | 305/500 [23:09<14:29,  4.46s/it]

 61%|███████████████████████████████████████████████████████████████████████████▉                                                | 306/500 [23:14<14:14,  4.40s/it]

 61%|████████████████████████████████████████████████████████████████████████████▏                                               | 307/500 [23:18<14:05,  4.38s/it]
 61%|████████████████████████████████████████████████████████████████████████████▏                                               | 307/500 [23:18<14:05,  4.38s/it]Traceback (most recent call last):
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 245, in <module>
    main()
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 241, in main
    trainer.train()
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\trl\trainer\sft_trainer.py", line 451, in train
    output = super().train(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 1948, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2289, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3328, in training_step
    loss = self.compute_loss(model, inputs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3373, in compute_loss
    outputs = model(**inputs)
              ^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\accelerate\utils\operations.py", line 819, in forward
    return model_forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\accelerate\utils\operations.py", line 807, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\amp\autocast_mode.py", line 43, in decorate_autocast
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\peft\peft_model.py", line 1577, in forward
    return self.base_model(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\peft\tuners\tuners_utils.py", line 188, in forward
    return self.model.forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\accelerate\hooks.py", line 169, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 1189, in forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\accelerate\hooks.py", line 169, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 1001, in forward
    layer_outputs = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\accelerate\hooks.py", line 169, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 734, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
                                                          ^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\accelerate\hooks.py", line 169, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\models\llama\modeling_llama.py", line 617, in forward
    query_states = self.q_proj(hidden_states)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\peft\tuners\lora\bnb.py", line 467, in forward
    result = self.base_layer(x, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\accelerate\hooks.py", line 169, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\bitsandbytes\nn\modules.py", line 479, in forward
    out = out.to(inp_dtype)
          ^^^^^^^^^^^^^^^^^
KeyboardInterrupt