
  0%|                                                                                                                                             | 0/500 [00:00<?, ?it/s]

  0%|▎                                                                                                                                    | 1/500 [00:04<35:14,  4.24s/it]

  0%|▌                                                                                                                                    | 2/500 [00:08<33:34,  4.05s/it]

  1%|▊                                                                                                                                    | 3/500 [00:12<33:14,  4.01s/it]

  1%|█                                                                                                                                    | 4/500 [00:16<33:02,  4.00s/it]

  1%|█▎                                                                                                                                   | 5/500 [00:20<32:52,  3.98s/it]

  1%|█▌                                                                                                                                   | 6/500 [00:23<32:38,  3.96s/it]


  2%|██▏                                                                                                                                  | 8/500 [00:31<32:18,  3.94s/it]

  2%|██▍                                                                                                                                  | 9/500 [00:35<32:16,  3.94s/it]
{'loss': 2.2687, 'grad_norm': 1.3480966091156006, 'learning_rate': 4.91e-05, 'epoch': 0.0}

  2%|██▋                                                                                                                                 | 10/500 [00:39<32:20,  3.96s/it]

  2%|██▉                                                                                                                                 | 11/500 [00:44<35:06,  4.31s/it]

  2%|███▏                                                                                                                                | 12/500 [00:48<34:05,  4.19s/it]

  3%|███▍                                                                                                                                | 13/500 [00:52<33:29,  4.13s/it]

  3%|███▋                                                                                                                                | 14/500 [00:56<33:03,  4.08s/it]

  3%|███▉                                                                                                                                | 15/500 [01:00<32:48,  4.06s/it]

  3%|████▏                                                                                                                               | 16/500 [01:04<32:40,  4.05s/it]

  3%|████▍                                                                                                                               | 17/500 [01:08<32:24,  4.03s/it]

  4%|████▊                                                                                                                               | 18/500 [01:13<32:52,  4.09s/it]

  4%|█████                                                                                                                               | 19/500 [01:17<33:01,  4.12s/it]

  4%|█████▎                                                                                                                              | 20/500 [01:21<32:47,  4.10s/it]

  4%|█████▌                                                                                                                              | 21/500 [01:25<33:51,  4.24s/it]

  4%|█████▊                                                                                                                              | 22/500 [01:29<32:50,  4.12s/it]

  5%|██████                                                                                                                              | 23/500 [01:33<32:25,  4.08s/it]

  5%|██████▎                                                                                                                             | 24/500 [01:37<31:58,  4.03s/it]

  5%|██████▌                                                                                                                             | 25/500 [01:41<31:43,  4.01s/it]

  5%|██████▊                                                                                                                             | 26/500 [01:45<31:30,  3.99s/it]

  5%|███████▏                                                                                                                            | 27/500 [01:49<31:18,  3.97s/it]

  6%|███████▍                                                                                                                            | 28/500 [01:53<31:04,  3.95s/it]

  6%|███████▋                                                                                                                            | 29/500 [01:57<31:00,  3.95s/it]

  6%|███████▉                                                                                                                            | 30/500 [02:01<30:50,  3.94s/it]

  6%|████████▏                                                                                                                           | 31/500 [02:05<32:25,  4.15s/it]

  6%|████████▍                                                                                                                           | 32/500 [02:09<31:47,  4.08s/it]

  7%|████████▋                                                                                                                           | 33/500 [02:13<31:24,  4.04s/it]

  7%|████████▉                                                                                                                           | 34/500 [02:17<31:08,  4.01s/it]

  7%|█████████▏                                                                                                                          | 35/500 [02:21<30:42,  3.96s/it]

  7%|█████████▌                                                                                                                          | 36/500 [02:25<30:20,  3.92s/it]

  7%|█████████▊                                                                                                                          | 37/500 [02:29<30:18,  3.93s/it]

  8%|██████████                                                                                                                          | 38/500 [02:33<30:23,  3.95s/it]

  8%|██████████▎                                                                                                                         | 39/500 [02:37<30:19,  3.95s/it]


  8%|██████████▊                                                                                                                         | 41/500 [02:45<32:17,  4.22s/it]

  8%|███████████                                                                                                                         | 42/500 [02:49<31:41,  4.15s/it]
{'loss': 1.3724, 'grad_norm': 1.3230550289154053, 'learning_rate': 4.58e-05, 'epoch': 0.0}

  9%|███████████▎                                                                                                                        | 43/500 [02:53<31:02,  4.08s/it]

  9%|███████████▌                                                                                                                        | 44/500 [02:57<30:40,  4.04s/it]

  9%|███████████▉                                                                                                                        | 45/500 [03:01<30:22,  4.00s/it]

  9%|████████████▏                                                                                                                       | 46/500 [03:05<30:15,  4.00s/it]

  9%|████████████▍                                                                                                                       | 47/500 [03:09<30:04,  3.98s/it]

 10%|████████████▋                                                                                                                       | 48/500 [03:13<29:49,  3.96s/it]

 10%|████████████▉                                                                                                                       | 49/500 [03:17<29:43,  3.96s/it]

 10%|█████████████▏                                                                                                                      | 50/500 [03:21<29:55,  3.99s/it]

 10%|█████████████▍                                                                                                                      | 51/500 [03:26<31:23,  4.19s/it]


 11%|█████████████▉                                                                                                                      | 53/500 [03:34<30:13,  4.06s/it]
{'loss': 0.9686, 'grad_norm': 1.3259673118591309, 'learning_rate': 4.47e-05, 'epoch': 0.0}

 11%|██████████████▎                                                                                                                     | 54/500 [03:37<29:41,  4.00s/it]

 11%|██████████████▌                                                                                                                     | 55/500 [03:41<29:25,  3.97s/it]

 11%|██████████████▊                                                                                                                     | 56/500 [03:45<29:09,  3.94s/it]

 11%|███████████████                                                                                                                     | 57/500 [03:49<29:06,  3.94s/it]

 12%|███████████████▎                                                                                                                    | 58/500 [03:53<28:50,  3.92s/it]

 12%|███████████████▌                                                                                                                    | 59/500 [03:57<28:47,  3.92s/it]


 12%|████████████████                                                                                                                    | 61/500 [04:06<30:18,  4.14s/it]
{'loss': 1.1644, 'grad_norm': 1.3305623531341553, 'learning_rate': 4.39e-05, 'epoch': 0.01}

 12%|████████████████▎                                                                                                                   | 62/500 [04:09<29:35,  4.05s/it]

 13%|████████████████▋                                                                                                                   | 63/500 [04:13<29:21,  4.03s/it]

 13%|████████████████▉                                                                                                                   | 64/500 [04:17<29:09,  4.01s/it]

 13%|█████████████████▏                                                                                                                  | 65/500 [04:21<28:51,  3.98s/it]

 13%|█████████████████▍                                                                                                                  | 66/500 [04:25<28:42,  3.97s/it]

 13%|█████████████████▋                                                                                                                  | 67/500 [04:29<28:47,  3.99s/it]

 14%|█████████████████▉                                                                                                                  | 68/500 [04:33<28:48,  4.00s/it]

 14%|██████████████████▏                                                                                                                 | 69/500 [04:37<28:41,  3.99s/it]

 14%|██████████████████▍                                                                                                                 | 70/500 [04:41<28:31,  3.98s/it]

 14%|██████████████████▋                                                                                                                 | 71/500 [04:46<29:49,  4.17s/it]

 14%|███████████████████                                                                                                                 | 72/500 [04:50<29:10,  4.09s/it]

 15%|███████████████████▎                                                                                                                | 73/500 [04:54<28:36,  4.02s/it]

 15%|███████████████████▌                                                                                                                | 74/500 [04:57<28:27,  4.01s/it]

 15%|███████████████████▊                                                                                                                | 75/500 [05:01<28:11,  3.98s/it]

 15%|████████████████████                                                                                                                | 76/500 [05:06<28:24,  4.02s/it]

 15%|████████████████████▎                                                                                                               | 77/500 [05:10<28:44,  4.08s/it]

 16%|████████████████████▌                                                                                                               | 78/500 [05:14<28:48,  4.10s/it]

 16%|████████████████████▊                                                                                                               | 79/500 [05:18<28:47,  4.10s/it]

 16%|█████████████████████                                                                                                               | 80/500 [05:22<28:47,  4.11s/it]

 16%|█████████████████████▍                                                                                                              | 81/500 [05:27<30:12,  4.33s/it]

 16%|█████████████████████▋                                                                                                              | 82/500 [05:31<29:46,  4.27s/it]


 17%|██████████████████████▏                                                                                                             | 84/500 [05:40<29:31,  4.26s/it]

 17%|██████████████████████▍                                                                                                             | 85/500 [05:44<29:07,  4.21s/it]
{'loss': 1.0095, 'grad_norm': 1.6652336120605469, 'learning_rate': 4.15e-05, 'epoch': 0.01}

 17%|██████████████████████▋                                                                                                             | 86/500 [05:48<29:05,  4.22s/it]

 17%|██████████████████████▉                                                                                                             | 87/500 [05:52<28:56,  4.21s/it]

 18%|███████████████████████▏                                                                                                            | 88/500 [05:56<28:54,  4.21s/it]

 18%|███████████████████████▍                                                                                                            | 89/500 [06:01<28:58,  4.23s/it]


 18%|████████████████████████                                                                                                            | 91/500 [06:10<30:13,  4.43s/it]
{'loss': 1.1613, 'grad_norm': 1.347456455230713, 'learning_rate': 4.09e-05, 'epoch': 0.01}

 18%|████████████████████████▎                                                                                                           | 92/500 [06:14<29:55,  4.40s/it]

 19%|████████████████████████▌                                                                                                           | 93/500 [06:18<29:15,  4.31s/it]

 19%|████████████████████████▊                                                                                                           | 94/500 [06:22<28:59,  4.28s/it]

 19%|█████████████████████████                                                                                                           | 95/500 [06:27<28:41,  4.25s/it]

 19%|█████████████████████████▎                                                                                                          | 96/500 [06:31<28:24,  4.22s/it]

 19%|█████████████████████████▌                                                                                                          | 97/500 [06:35<28:12,  4.20s/it]

 20%|█████████████████████████▊                                                                                                          | 98/500 [06:39<27:57,  4.17s/it]

 20%|██████████████████████████▏                                                                                                         | 99/500 [06:43<27:46,  4.16s/it]

 20%|██████████████████████████▏                                                                                                        | 100/500 [06:47<27:40,  4.15s/it]

 20%|██████████████████████████▍                                                                                                        | 101/500 [06:52<28:53,  4.34s/it]

 20%|██████████████████████████▋                                                                                                        | 102/500 [06:56<28:27,  4.29s/it]

 21%|██████████████████████████▉                                                                                                        | 103/500 [07:00<28:07,  4.25s/it]

 21%|███████████████████████████▏                                                                                                       | 104/500 [07:04<27:52,  4.22s/it]

 21%|███████████████████████████▌                                                                                                       | 105/500 [07:09<27:36,  4.19s/it]

 21%|███████████████████████████▊                                                                                                       | 106/500 [07:13<27:37,  4.21s/it]

 21%|████████████████████████████                                                                                                       | 107/500 [07:17<27:20,  4.17s/it]

 22%|████████████████████████████▎                                                                                                      | 108/500 [07:21<27:19,  4.18s/it]

 22%|████████████████████████████▌                                                                                                      | 109/500 [07:25<27:08,  4.17s/it]

 22%|████████████████████████████▊                                                                                                      | 110/500 [07:29<27:05,  4.17s/it]

 22%|█████████████████████████████                                                                                                      | 111/500 [07:34<28:16,  4.36s/it]

 22%|█████████████████████████████▎                                                                                                     | 112/500 [07:38<27:47,  4.30s/it]

 23%|█████████████████████████████▌                                                                                                     | 113/500 [07:43<27:24,  4.25s/it]

 23%|█████████████████████████████▊                                                                                                     | 114/500 [07:47<27:12,  4.23s/it]

 23%|██████████████████████████████▏                                                                                                    | 115/500 [07:51<27:04,  4.22s/it]

 23%|██████████████████████████████▍                                                                                                    | 116/500 [07:55<27:02,  4.23s/it]

 23%|██████████████████████████████▋                                                                                                    | 117/500 [07:59<26:48,  4.20s/it]

 24%|██████████████████████████████▉                                                                                                    | 118/500 [08:03<26:42,  4.20s/it]

 24%|███████████████████████████████▏                                                                                                   | 119/500 [08:08<26:35,  4.19s/it]

 24%|███████████████████████████████▍                                                                                                   | 120/500 [08:12<26:36,  4.20s/it]

 24%|███████████████████████████████▋                                                                                                   | 121/500 [08:17<27:30,  4.35s/it]

 24%|███████████████████████████████▉                                                                                                   | 122/500 [08:21<27:03,  4.29s/it]

 25%|████████████████████████████████▏                                                                                                  | 123/500 [08:25<26:40,  4.25s/it]

 25%|████████████████████████████████▍                                                                                                  | 124/500 [08:29<26:25,  4.22s/it]Traceback (most recent call last):
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 241, in <module>
    main()
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 237, in main
    trainer.train()
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\trl\trainer\sft_trainer.py", line 451, in train
    output = super().train(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 1948, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2289, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3359, in training_step
    self.accelerator.backward(loss, **kwargs)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\accelerate\accelerator.py", line 2155, in backward
    self.scaler.scale(loss).backward(**kwargs)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\autograd\__init__.py", line 289, in backward
    _engine_run_backward(
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\autograd\graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt