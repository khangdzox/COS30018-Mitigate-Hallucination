
  0%|                                                                                                                                                                           | 0/500 [00:00<?, ?it/s]

  0%|▎                                                                                                                                                                | 1/500 [00:08<1:08:02,  8.18s/it]

  0%|▋                                                                                                                                                                | 2/500 [00:16<1:06:17,  7.99s/it]

  1%|▉                                                                                                                                                                | 3/500 [00:24<1:06:06,  7.98s/it]


  1%|█▌                                                                                                                                                               | 5/500 [00:39<1:05:25,  7.93s/it]
{'loss': 2.336, 'grad_norm': 4.187209129333496, 'learning_rate': 0.0032, 'epoch': 0.0}

  1%|█▉                                                                                                                                                               | 6/500 [00:47<1:04:59,  7.89s/it]

  1%|██▎                                                                                                                                                              | 7/500 [00:55<1:04:55,  7.90s/it]

  2%|██▌                                                                                                                                                              | 8/500 [01:03<1:04:42,  7.89s/it]

  2%|██▉                                                                                                                                                              | 9/500 [01:11<1:04:28,  7.88s/it]

  2%|███▏                                                                                                                                                            | 10/500 [01:19<1:04:27,  7.89s/it]


  2%|███▊                                                                                                                                                            | 12/500 [01:35<1:05:48,  8.09s/it]

  3%|████▏                                                                                                                                                           | 13/500 [01:43<1:05:12,  8.03s/it]

  3%|████▍                                                                                                                                                           | 14/500 [01:51<1:04:52,  8.01s/it]
{'loss': 2.3789, 'grad_norm': 3.886583089828491, 'learning_rate': 0.008, 'epoch': 0.0}

  3%|████▊                                                                                                                                                           | 15/500 [01:59<1:04:24,  7.97s/it]

  3%|█████                                                                                                                                                           | 16/500 [02:07<1:04:08,  7.95s/it]

  3%|█████▍                                                                                                                                                          | 17/500 [02:15<1:04:02,  7.96s/it]

  4%|█████▊                                                                                                                                                          | 18/500 [02:23<1:03:33,  7.91s/it]

  4%|██████                                                                                                                                                          | 19/500 [02:31<1:03:45,  7.95s/it]


  4%|██████▋                                                                                                                                                         | 21/500 [02:47<1:05:02,  8.15s/it]
{'loss': 2.0957, 'grad_norm': 4.816437244415283, 'learning_rate': 0.013600000000000001, 'epoch': 0.0}

  4%|███████                                                                                                                                                         | 22/500 [02:55<1:04:10,  8.06s/it]

  5%|███████▎                                                                                                                                                        | 23/500 [03:03<1:03:32,  7.99s/it]

  5%|███████▋                                                                                                                                                        | 24/500 [03:11<1:03:11,  7.97s/it]

  5%|████████                                                                                                                                                        | 25/500 [03:19<1:02:56,  7.95s/it]

  5%|████████▎                                                                                                                                                       | 26/500 [03:27<1:02:40,  7.93s/it]

  5%|████████▋                                                                                                                                                       | 27/500 [03:35<1:02:28,  7.93s/it]

  6%|████████▉                                                                                                                                                       | 28/500 [03:43<1:02:15,  7.91s/it]

  6%|█████████▎                                                                                                                                                      | 29/500 [03:51<1:01:59,  7.90s/it]

  6%|█████████▌                                                                                                                                                      | 30/500 [03:58<1:01:31,  7.85s/it]

  6%|█████████▉                                                                                                                                                      | 31/500 [04:07<1:03:06,  8.07s/it]

  6%|██████████▏                                                                                                                                                     | 32/500 [04:15<1:02:27,  8.01s/it]

  7%|██████████▌                                                                                                                                                     | 33/500 [04:23<1:02:04,  7.98s/it]

  7%|██████████▉                                                                                                                                                     | 34/500 [04:30<1:01:35,  7.93s/it]

  7%|███████████▏                                                                                                                                                    | 35/500 [04:38<1:01:01,  7.87s/it]

  7%|███████████▌                                                                                                                                                    | 36/500 [04:46<1:01:08,  7.91s/it]

  7%|███████████▊                                                                                                                                                    | 37/500 [04:54<1:00:54,  7.89s/it]

  8%|████████████▏                                                                                                                                                   | 38/500 [05:02<1:00:48,  7.90s/it]

  8%|████████████▍                                                                                                                                                   | 39/500 [05:10<1:00:39,  7.90s/it]

  8%|████████████▊                                                                                                                                                   | 40/500 [05:18<1:00:38,  7.91s/it]

  8%|█████████████                                                                                                                                                   | 41/500 [05:26<1:01:49,  8.08s/it]

  8%|█████████████▍                                                                                                                                                  | 42/500 [05:34<1:01:07,  8.01s/it]

  9%|█████████████▊                                                                                                                                                  | 43/500 [05:42<1:00:37,  7.96s/it]


  9%|██████████████▍                                                                                                                                                 | 45/500 [05:58<1:00:10,  7.94s/it]

  9%|██████████████▉                                                                                                                                                   | 46/500 [06:06<59:53,  7.92s/it]
{'loss': 1.5589, 'grad_norm': 12.524595260620117, 'learning_rate': 0.019944060680666002, 'epoch': 0.01}

  9%|███████████████▏                                                                                                                                                  | 47/500 [06:14<59:44,  7.91s/it]

 10%|███████████████▌                                                                                                                                                  | 48/500 [06:22<59:47,  7.94s/it]

 10%|███████████████▉                                                                                                                                                  | 49/500 [06:29<59:39,  7.94s/it]

 10%|████████████████▏                                                                                                                                                 | 50/500 [06:37<59:19,  7.91s/it]

 10%|████████████████▎                                                                                                                                               | 51/500 [06:46<1:01:08,  8.17s/it]


 11%|█████████████████▏                                                                                                                                                | 53/500 [07:02<59:43,  8.02s/it]

 11%|█████████████████▍                                                                                                                                                | 54/500 [07:10<59:30,  8.01s/it]
{'loss': 1.5461, 'grad_norm': 11.585079193115234, 'learning_rate': 0.019874283308955056, 'epoch': 0.01}

 11%|█████████████████▊                                                                                                                                                | 55/500 [07:18<58:59,  7.95s/it]

 11%|██████████████████▏                                                                                                                                               | 56/500 [07:26<58:44,  7.94s/it]

 11%|██████████████████▍                                                                                                                                               | 57/500 [07:33<58:39,  7.94s/it]

 12%|██████████████████▊                                                                                                                                               | 58/500 [07:41<58:29,  7.94s/it]

 12%|███████████████████                                                                                                                                               | 59/500 [07:49<58:24,  7.95s/it]

 12%|███████████████████▍                                                                                                                                              | 60/500 [07:57<58:05,  7.92s/it]

 12%|███████████████████▊                                                                                                                                              | 61/500 [08:06<59:04,  8.07s/it]

 12%|████████████████████                                                                                                                                              | 62/500 [08:14<58:27,  8.01s/it]

 13%|████████████████████▍                                                                                                                                             | 63/500 [08:22<58:14,  8.00s/it]

 13%|████████████████████▋                                                                                                                                             | 64/500 [08:29<57:46,  7.95s/it]

 13%|█████████████████████                                                                                                                                             | 65/500 [08:37<57:28,  7.93s/it]

 13%|█████████████████████▍                                                                                                                                            | 66/500 [08:45<57:25,  7.94s/it]

 13%|█████████████████████▋                                                                                                                                            | 67/500 [08:53<56:59,  7.90s/it]

 14%|██████████████████████                                                                                                                                            | 68/500 [09:01<56:55,  7.91s/it]

 14%|██████████████████████▎                                                                                                                                           | 69/500 [09:09<56:46,  7.90s/it]

 14%|██████████████████████▋                                                                                                                                           | 70/500 [09:17<56:39,  7.91s/it]

 14%|███████████████████████                                                                                                                                           | 71/500 [09:26<58:37,  8.20s/it]

 14%|███████████████████████▎                                                                                                                                          | 72/500 [09:34<57:54,  8.12s/it]

 15%|███████████████████████▋                                                                                                                                          | 73/500 [09:41<57:11,  8.04s/it]

 15%|███████████████████████▉                                                                                                                                          | 74/500 [09:49<56:50,  8.00s/it]

 15%|████████████████████████▎                                                                                                                                         | 75/500 [09:57<56:24,  7.96s/it]

 15%|████████████████████████▌                                                                                                                                         | 76/500 [10:05<56:07,  7.94s/it]

 15%|████████████████████████▉                                                                                                                                         | 77/500 [10:13<55:44,  7.91s/it]

 16%|█████████████████████████▎                                                                                                                                        | 78/500 [10:21<55:36,  7.91s/it]

 16%|█████████████████████████▌                                                                                                                                        | 79/500 [10:29<55:34,  7.92s/it]

 16%|█████████████████████████▉                                                                                                                                        | 80/500 [10:37<55:26,  7.92s/it]

 16%|██████████████████████████▏                                                                                                                                       | 81/500 [10:45<56:35,  8.10s/it]

 16%|██████████████████████████▌                                                                                                                                       | 82/500 [10:53<55:48,  8.01s/it]

 17%|██████████████████████████▉                                                                                                                                       | 83/500 [11:01<55:25,  7.97s/it]

 17%|███████████████████████████▏                                                                                                                                      | 84/500 [11:09<55:08,  7.95s/it]

 17%|███████████████████████████▌                                                                                                                                      | 85/500 [11:17<54:46,  7.92s/it]

 17%|███████████████████████████▊                                                                                                                                      | 86/500 [11:25<54:55,  7.96s/it]

 17%|████████████████████████████▏                                                                                                                                     | 87/500 [11:33<54:41,  7.95s/it]

 18%|████████████████████████████▌                                                                                                                                     | 88/500 [11:40<54:20,  7.91s/it]

 18%|████████████████████████████▊                                                                                                                                     | 89/500 [11:48<54:01,  7.89s/it]

 18%|█████████████████████████████▏                                                                                                                                    | 90/500 [11:56<53:52,  7.88s/it]

 18%|█████████████████████████████▍                                                                                                                                    | 91/500 [12:05<54:48,  8.04s/it]

 18%|█████████████████████████████▊                                                                                                                                    | 92/500 [12:12<54:25,  8.00s/it]

 19%|██████████████████████████████▏                                                                                                                                   | 93/500 [12:20<54:14,  8.00s/it]

 19%|██████████████████████████████▍                                                                                                                                   | 94/500 [12:29<54:18,  8.03s/it]

 19%|██████████████████████████████▊                                                                                                                                   | 95/500 [12:37<54:02,  8.01s/it]

 19%|███████████████████████████████                                                                                                                                   | 96/500 [12:45<54:02,  8.03s/it]

 19%|███████████████████████████████▍                                                                                                                                  | 97/500 [12:53<53:54,  8.03s/it]

 20%|███████████████████████████████▊                                                                                                                                  | 98/500 [13:01<53:58,  8.06s/it]

 20%|████████████████████████████████                                                                                                                                  | 99/500 [13:09<53:43,  8.04s/it]

 20%|████████████████████████████████▏                                                                                                                                | 100/500 [13:17<53:17,  7.99s/it]

 20%|████████████████████████████████▌                                                                                                                                | 101/500 [13:25<54:53,  8.25s/it]

 20%|████████████████████████████████▊                                                                                                                                | 102/500 [13:33<53:58,  8.14s/it]

 21%|█████████████████████████████████▏                                                                                                                               | 103/500 [13:41<53:18,  8.06s/it]

 21%|█████████████████████████████████▍                                                                                                                               | 104/500 [13:49<53:13,  8.06s/it]

 21%|█████████████████████████████████▊                                                                                                                               | 105/500 [13:57<53:20,  8.10s/it]

 21%|██████████████████████████████████▏                                                                                                                              | 106/500 [14:06<53:07,  8.09s/it]

 21%|██████████████████████████████████▍                                                                                                                              | 107/500 [14:13<52:40,  8.04s/it]

 22%|██████████████████████████████████▊                                                                                                                              | 108/500 [14:22<52:38,  8.06s/it]

 22%|███████████████████████████████████                                                                                                                              | 109/500 [14:30<52:23,  8.04s/it]

 22%|███████████████████████████████████▍                                                                                                                             | 110/500 [14:38<52:13,  8.04s/it]

 22%|███████████████████████████████████▋                                                                                                                             | 111/500 [14:46<53:23,  8.24s/it]

 22%|████████████████████████████████████                                                                                                                             | 112/500 [14:54<52:55,  8.18s/it]

 23%|████████████████████████████████████▍                                                                                                                            | 113/500 [15:02<52:32,  8.15s/it]

 23%|████████████████████████████████████▋                                                                                                                            | 114/500 [15:10<52:07,  8.10s/it]

 23%|█████████████████████████████████████                                                                                                                            | 115/500 [15:18<51:42,  8.06s/it]

 23%|█████████████████████████████████████▎                                                                                                                           | 116/500 [15:26<51:25,  8.03s/it]

 23%|█████████████████████████████████████▋                                                                                                                           | 117/500 [15:34<51:03,  8.00s/it]

 24%|█████████████████████████████████████▉                                                                                                                           | 118/500 [15:42<50:40,  7.96s/it]


 24%|██████████████████████████████████████▋                                                                                                                          | 120/500 [15:58<50:12,  7.93s/it]
{'loss': 1.1826, 'grad_norm': 3.050313711166382, 'learning_rate': 0.0182800883114802, 'epoch': 0.02}

 24%|██████████████████████████████████████▉                                                                                                                          | 121/500 [16:07<51:21,  8.13s/it]

 24%|███████████████████████████████████████▎                                                                                                                         | 122/500 [16:15<51:17,  8.14s/it]

 25%|███████████████████████████████████████▌                                                                                                                         | 123/500 [16:23<51:06,  8.13s/it]

 25%|███████████████████████████████████████▉                                                                                                                         | 124/500 [16:31<50:42,  8.09s/it]

 25%|████████████████████████████████████████▎                                                                                                                        | 125/500 [16:39<50:38,  8.10s/it]

 25%|████████████████████████████████████████▌                                                                                                                        | 126/500 [16:47<50:10,  8.05s/it]

 25%|████████████████████████████████████████▉                                                                                                                        | 127/500 [16:55<49:49,  8.01s/it]

 26%|█████████████████████████████████████████▏                                                                                                                       | 128/500 [17:03<49:30,  7.98s/it]

 26%|█████████████████████████████████████████▌                                                                                                                       | 129/500 [17:11<49:11,  7.96s/it]

 26%|█████████████████████████████████████████▊                                                                                                                       | 130/500 [17:19<49:08,  7.97s/it]

 26%|██████████████████████████████████████████▏                                                                                                                      | 131/500 [17:27<50:42,  8.24s/it]

 26%|██████████████████████████████████████████▌                                                                                                                      | 132/500 [17:36<50:10,  8.18s/it]

 27%|██████████████████████████████████████████▊                                                                                                                      | 133/500 [17:43<49:33,  8.10s/it]

 27%|███████████████████████████████████████████▏                                                                                                                     | 134/500 [17:51<49:12,  8.07s/it]

 27%|███████████████████████████████████████████▍                                                                                                                     | 135/500 [17:59<48:32,  7.98s/it]

 27%|███████████████████████████████████████████▊                                                                                                                     | 136/500 [18:07<48:09,  7.94s/it]

 27%|████████████████████████████████████████████                                                                                                                     | 137/500 [18:15<48:01,  7.94s/it]

 28%|████████████████████████████████████████████▍                                                                                                                    | 138/500 [18:23<47:49,  7.93s/it]

 28%|████████████████████████████████████████████▊                                                                                                                    | 139/500 [18:31<47:46,  7.94s/it]Traceback (most recent call last):
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 243, in <module>
    main()
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 239, in main
    trainer.train()
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\trl\trainer\sft_trainer.py", line 451, in train
    output = super().train(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 1948, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2294, in _inner_training_loop
    and (torch.isnan(tr_loss_step) or torch.isinf(tr_loss_step))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt