
  0%|                                                                                                                                                                           | 0/500 [00:00<?, ?it/s]

  0%|▎                                                                                                                                                                | 1/500 [00:08<1:08:36,  8.25s/it]

  0%|▋                                                                                                                                                                | 2/500 [00:16<1:07:31,  8.14s/it]

  1%|▉                                                                                                                                                                | 3/500 [00:24<1:07:33,  8.16s/it]

  1%|█▎                                                                                                                                                               | 4/500 [00:32<1:07:30,  8.17s/it]

  1%|█▌                                                                                                                                                               | 5/500 [00:40<1:07:07,  8.14s/it]

  1%|█▉                                                                                                                                                               | 6/500 [00:48<1:06:25,  8.07s/it]

  1%|██▎                                                                                                                                                              | 7/500 [00:56<1:06:11,  8.06s/it]

  2%|██▌                                                                                                                                                              | 8/500 [01:04<1:05:52,  8.03s/it]

  2%|██▉                                                                                                                                                              | 9/500 [01:12<1:05:39,  8.02s/it]

  2%|███▏                                                                                                                                                            | 10/500 [01:20<1:05:38,  8.04s/it]

  2%|███▌                                                                                                                                                            | 11/500 [01:29<1:07:10,  8.24s/it]

  2%|███▊                                                                                                                                                            | 12/500 [01:37<1:06:12,  8.14s/it]

  3%|████▏                                                                                                                                                           | 13/500 [01:45<1:05:52,  8.12s/it]

  3%|████▍                                                                                                                                                           | 14/500 [01:53<1:05:40,  8.11s/it]

  3%|████▊                                                                                                                                                           | 15/500 [02:01<1:05:16,  8.08s/it]

  3%|█████                                                                                                                                                           | 16/500 [02:09<1:05:06,  8.07s/it]

  3%|█████▍                                                                                                                                                          | 17/500 [02:17<1:05:06,  8.09s/it]

  4%|█████▊                                                                                                                                                          | 18/500 [02:25<1:04:38,  8.05s/it]


  4%|██████▍                                                                                                                                                         | 20/500 [02:41<1:04:47,  8.10s/it]
{'loss': 2.0926, 'grad_norm': 5.41852331161499, 'learning_rate': 0.0144, 'epoch': 0.0}

  4%|██████▋                                                                                                                                                         | 21/500 [02:51<1:07:07,  8.41s/it]

  4%|███████                                                                                                                                                         | 22/500 [02:59<1:05:53,  8.27s/it]

  5%|███████▎                                                                                                                                                        | 23/500 [03:06<1:04:39,  8.13s/it]

  5%|███████▋                                                                                                                                                        | 24/500 [03:14<1:04:00,  8.07s/it]

  5%|████████                                                                                                                                                        | 25/500 [03:22<1:03:47,  8.06s/it]

  5%|████████▎                                                                                                                                                       | 26/500 [03:30<1:03:38,  8.06s/it]

  5%|████████▋                                                                                                                                                       | 27/500 [03:38<1:03:35,  8.07s/it]

  6%|████████▉                                                                                                                                                       | 28/500 [03:47<1:03:26,  8.07s/it]

  6%|█████████▎                                                                                                                                                      | 29/500 [03:55<1:03:15,  8.06s/it]

  6%|█████████▌                                                                                                                                                      | 30/500 [04:02<1:02:46,  8.01s/it]

  6%|█████████▉                                                                                                                                                      | 31/500 [04:11<1:04:26,  8.24s/it]

  6%|██████████▏                                                                                                                                                     | 32/500 [04:19<1:03:18,  8.12s/it]

  7%|██████████▌                                                                                                                                                     | 33/500 [04:27<1:03:12,  8.12s/it]

  7%|██████████▉                                                                                                                                                     | 34/500 [04:35<1:02:32,  8.05s/it]

  7%|███████████▏                                                                                                                                                    | 35/500 [04:43<1:01:47,  7.97s/it]

  7%|███████████▌                                                                                                                                                    | 36/500 [04:51<1:01:46,  7.99s/it]

  7%|███████████▊                                                                                                                                                    | 37/500 [04:59<1:01:29,  7.97s/it]

  8%|████████████▏                                                                                                                                                   | 38/500 [05:07<1:01:21,  7.97s/it]

  8%|████████████▍                                                                                                                                                   | 39/500 [05:15<1:01:08,  7.96s/it]


  8%|█████████████                                                                                                                                                   | 41/500 [05:32<1:03:13,  8.26s/it]

  8%|█████████████▍                                                                                                                                                  | 42/500 [05:40<1:02:22,  8.17s/it]
{'loss': 1.6401, 'grad_norm': 31.401432037353516, 'learning_rate': 0.019963059593496268, 'epoch': 0.01}

  9%|█████████████▊                                                                                                                                                  | 43/500 [05:48<1:01:39,  8.10s/it]


  9%|██████████████▍                                                                                                                                                 | 45/500 [06:04<1:01:11,  8.07s/it]

  9%|██████████████▋                                                                                                                                                 | 46/500 [06:12<1:00:57,  8.06s/it]

  9%|███████████████                                                                                                                                                 | 47/500 [06:20<1:00:53,  8.07s/it]
{'loss': 1.4536, 'grad_norm': 17.896793365478516, 'learning_rate': 0.01992921934990939, 'epoch': 0.01}

 10%|███████████████▎                                                                                                                                                | 48/500 [06:28<1:00:53,  8.08s/it]

 10%|███████████████▋                                                                                                                                                | 49/500 [06:36<1:00:50,  8.09s/it]

 10%|████████████████                                                                                                                                                | 50/500 [06:44<1:00:32,  8.07s/it]

 10%|████████████████▎                                                                                                                                               | 51/500 [06:53<1:01:39,  8.24s/it]

 10%|████████████████▋                                                                                                                                               | 52/500 [07:01<1:00:57,  8.16s/it]

 11%|████████████████▉                                                                                                                                               | 53/500 [07:09<1:00:29,  8.12s/it]

 11%|█████████████████▎                                                                                                                                              | 54/500 [07:17<1:00:20,  8.12s/it]

 11%|█████████████████▊                                                                                                                                                | 55/500 [07:25<59:54,  8.08s/it]

 11%|██████████████████▏                                                                                                                                               | 56/500 [07:33<59:43,  8.07s/it]

 11%|██████████████████▍                                                                                                                                               | 57/500 [07:41<59:37,  8.08s/it]

 12%|██████████████████▊                                                                                                                                               | 58/500 [07:49<59:23,  8.06s/it]

 12%|███████████████████                                                                                                                                               | 59/500 [07:57<59:20,  8.07s/it]

 12%|███████████████████▍                                                                                                                                              | 60/500 [08:05<58:50,  8.02s/it]Traceback (most recent call last):
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 243, in <module>
    main()
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 239, in main
    trainer.train()
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\trl\trainer\sft_trainer.py", line 451, in train
    output = super().train(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 1948, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2366, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2817, in _maybe_log_save_evaluate
    self._save_checkpoint(model, trial, metrics=metrics)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2896, in _save_checkpoint
    self.save_model(output_dir, _internal_call=True)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3464, in save_model
    self._save(output_dir)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3540, in _save
    self.tokenizer.save_pretrained(output_dir)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\tokenization_utils_base.py", line 2697, in save_pretrained
    save_files = self._save_pretrained(
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\tokenization_utils_fast.py", line 708, in _save_pretrained
    self.backend_tokenizer.save(tokenizer_file)
Exception: The requested operation cannot be performed on a file with a user-mapped section open. (os error 1224)