

  0%|▎                                                                                                                                        | 1/500 [00:08<1:12:04,  8.67s/it]

  0%|▌                                                                                                                                        | 2/500 [00:16<1:08:24,  8.24s/it]

  1%|▊                                                                                                                                        | 3/500 [00:24<1:05:47,  7.94s/it]
{'loss': 2.3858, 'grad_norm': 5.1050591468811035, 'learning_rate': 8.000000000000001e-06, 'epoch': 0.0}


  1%|█▎                                                                                                                                       | 5/500 [00:39<1:04:46,  7.85s/it]

  1%|█▋                                                                                                                                       | 6/500 [00:47<1:04:39,  7.85s/it]

  1%|█▉                                                                                                                                       | 7/500 [00:55<1:04:05,  7.80s/it]

  2%|██▏                                                                                                                                      | 8/500 [01:03<1:03:58,  7.80s/it]

  2%|██▍                                                                                                                                      | 9/500 [01:10<1:03:39,  7.78s/it]

  2%|██▋                                                                                                                                     | 10/500 [01:18<1:03:26,  7.77s/it]

  2%|██▉                                                                                                                                     | 11/500 [01:27<1:07:07,  8.24s/it]

  2%|███▎                                                                                                                                    | 12/500 [01:35<1:06:00,  8.11s/it]

  3%|███▌                                                                                                                                    | 13/500 [01:43<1:05:21,  8.05s/it]

  3%|███▊                                                                                                                                    | 14/500 [01:51<1:04:33,  7.97s/it]

  3%|████                                                                                                                                    | 15/500 [01:59<1:04:09,  7.94s/it]

  3%|████▎                                                                                                                                   | 16/500 [02:07<1:03:45,  7.90s/it]

  3%|████▌                                                                                                                                   | 17/500 [02:15<1:03:42,  7.91s/it]

  4%|████▉                                                                                                                                   | 18/500 [02:22<1:03:29,  7.90s/it]

  4%|█████▏                                                                                                                                  | 19/500 [02:30<1:03:11,  7.88s/it]

  4%|█████▍                                                                                                                                  | 20/500 [02:38<1:02:45,  7.85s/it]

  4%|█████▋                                                                                                                                  | 21/500 [02:46<1:03:49,  8.00s/it]

  4%|█████▉                                                                                                                                  | 22/500 [02:54<1:03:11,  7.93s/it]

  5%|██████▎                                                                                                                                 | 23/500 [03:02<1:03:56,  8.04s/it]

  5%|██████▌                                                                                                                                 | 24/500 [03:11<1:04:29,  8.13s/it]

  5%|██████▊                                                                                                                                 | 25/500 [03:19<1:05:04,  8.22s/it]
{'loss': 1.707, 'grad_norm': 6.721275329589844, 'learning_rate': 9.200000000000001e-05, 'epoch': 0.0}


  5%|███████▎                                                                                                                                | 27/500 [03:36<1:06:04,  8.38s/it]

  6%|███████▌                                                                                                                                | 28/500 [03:45<1:06:09,  8.41s/it]

  6%|███████▉                                                                                                                                | 29/500 [03:53<1:06:21,  8.45s/it]
{'loss': 1.6239, 'grad_norm': 4.862897872924805, 'learning_rate': 9.993002688846913e-05, 'epoch': 0.0}


  6%|████████▍                                                                                                                               | 31/500 [04:11<1:07:22,  8.62s/it]

  6%|████████▋                                                                                                                               | 32/500 [04:19<1:07:22,  8.64s/it]
{'loss': 1.4767, 'grad_norm': 4.167296886444092, 'learning_rate': 9.956320346634876e-05, 'epoch': 0.0}


  7%|█████████▏                                                                                                                              | 34/500 [04:36<1:06:19,  8.54s/it]

  7%|█████████▌                                                                                                                              | 35/500 [04:45<1:06:26,  8.57s/it]

  7%|█████████▊                                                                                                                              | 36/500 [04:53<1:06:05,  8.55s/it]

  7%|██████████                                                                                                                              | 37/500 [05:02<1:05:53,  8.54s/it]

  8%|██████████▎                                                                                                                             | 38/500 [05:11<1:06:00,  8.57s/it]

  8%|██████████▌                                                                                                                             | 39/500 [05:22<1:11:23,  9.29s/it]

  8%|██████████▉                                                                                                                             | 40/500 [05:36<1:23:08, 10.84s/it]

  8%|███████████▏                                                                                                                            | 41/500 [05:47<1:23:01, 10.85s/it]

  8%|███████████▍                                                                                                                            | 42/500 [05:57<1:21:21, 10.66s/it]

  9%|███████████▋                                                                                                                            | 43/500 [06:07<1:20:04, 10.51s/it]

  9%|███████████▉                                                                                                                            | 44/500 [06:18<1:19:29, 10.46s/it]

  9%|████████████▏                                                                                                                           | 45/500 [06:28<1:18:22, 10.34s/it]
{'loss': 1.1002, 'grad_norm': 2.7383291721343994, 'learning_rate': 9.443717963884569e-05, 'epoch': 0.01}


  9%|████████████▊                                                                                                                           | 47/500 [06:49<1:18:21, 10.38s/it]

 10%|█████████████                                                                                                                           | 48/500 [06:59<1:17:57, 10.35s/it]

 10%|█████████████▎                                                                                                                          | 49/500 [07:09<1:18:14, 10.41s/it]

 10%|█████████████▌                                                                                                                          | 50/500 [07:20<1:17:34, 10.34s/it]

 10%|█████████████▊                                                                                                                          | 51/500 [07:31<1:18:55, 10.55s/it]

 10%|██████████████▏                                                                                                                         | 52/500 [07:41<1:18:19, 10.49s/it]

 11%|██████████████▍                                                                                                                         | 53/500 [07:51<1:18:06, 10.48s/it]

 11%|██████████████▋                                                                                                                         | 54/500 [08:02<1:17:18, 10.40s/it]

 11%|██████████████▉                                                                                                                         | 55/500 [08:12<1:16:35, 10.33s/it]
{'loss': 1.1284, 'grad_norm': 2.4472386837005615, 'learning_rate': 8.689798064925049e-05, 'epoch': 0.01}


 11%|███████████████▌                                                                                                                        | 57/500 [08:32<1:16:18, 10.33s/it]

 12%|███████████████▊                                                                                                                        | 58/500 [08:43<1:16:52, 10.44s/it]

 12%|████████████████                                                                                                                        | 59/500 [08:53<1:15:54, 10.33s/it]

 12%|████████████████▎                                                                                                                       | 60/500 [09:03<1:15:14, 10.26s/it]

 12%|████████████████▌                                                                                                                       | 61/500 [09:15<1:18:52, 10.78s/it]

 12%|████████████████▊                                                                                                                       | 62/500 [09:26<1:17:39, 10.64s/it]
{'loss': 1.2237, 'grad_norm': 2.884298086166382, 'learning_rate': 8.005405736415126e-05, 'epoch': 0.01}

 13%|█████████████████▏                                                                                                                      | 63/500 [09:36<1:17:14, 10.61s/it]


 13%|█████████████████▋                                                                                                                      | 65/500 [09:56<1:15:20, 10.39s/it]

 13%|█████████████████▉                                                                                                                      | 66/500 [10:07<1:15:12, 10.40s/it]

 13%|██████████████████▏                                                                                                                     | 67/500 [10:17<1:15:06, 10.41s/it]

 14%|██████████████████▍                                                                                                                     | 68/500 [10:28<1:14:36, 10.36s/it]

 14%|██████████████████▊                                                                                                                     | 69/500 [10:38<1:14:21, 10.35s/it]
{'loss': 1.1471, 'grad_norm': 2.7665464878082275, 'learning_rate': 7.218237771703921e-05, 'epoch': 0.01}


 14%|███████████████████▎                                                                                                                    | 71/500 [11:00<1:16:04, 10.64s/it]
{'loss': 1.0035, 'grad_norm': 2.6131017208099365, 'learning_rate': 6.978149344295242e-05, 'epoch': 0.01}


 15%|███████████████████▊                                                                                                                    | 73/500 [11:20<1:14:49, 10.51s/it]

 15%|████████████████████▏                                                                                                                   | 74/500 [11:31<1:14:23, 10.48s/it]

 15%|████████████████████▍                                                                                                                   | 75/500 [11:41<1:13:50, 10.42s/it]

 15%|████████████████████▋                                                                                                                   | 76/500 [11:51<1:13:09, 10.35s/it]

 15%|████████████████████▉                                                                                                                   | 77/500 [12:01<1:12:36, 10.30s/it]

 16%|█████████████████████▏                                                                                                                  | 78/500 [12:12<1:12:22, 10.29s/it]

 16%|█████████████████████▍                                                                                                                  | 79/500 [12:23<1:15:29, 10.76s/it]

 16%|█████████████████████▊                                                                                                                  | 80/500 [12:37<1:20:06, 11.44s/it]
{'loss': 0.9963, 'grad_norm': 2.1006407737731934, 'learning_rate': 5.969369490868042e-05, 'epoch': 0.01}

 16%|██████████████████████                                                                                                                  | 81/500 [12:50<1:24:05, 12.04s/it]Traceback (most recent call last):
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 243, in <module>
    main()
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 239, in main
    trainer.train()
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\trl\trainer\sft_trainer.py", line 451, in train
    output = super().train(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 1948, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2289, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3359, in training_step
    self.accelerator.backward(loss, **kwargs)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\accelerate\accelerator.py", line 2155, in backward
    self.scaler.scale(loss).backward(**kwargs)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\autograd\__init__.py", line 289, in backward
    _engine_run_backward(
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\autograd\graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt