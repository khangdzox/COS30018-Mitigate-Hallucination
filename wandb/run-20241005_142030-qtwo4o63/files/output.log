

  0%|▎                                                                                                                                          | 1/500 [00:02<21:36,  2.60s/it]

  0%|▌                                                                                                                                          | 2/500 [00:04<18:48,  2.27s/it]

  1%|▊                                                                                                                                          | 3/500 [00:06<17:46,  2.15s/it]

  1%|█                                                                                                                                          | 4/500 [00:08<17:30,  2.12s/it]

  1%|█▍                                                                                                                                         | 5/500 [00:10<17:09,  2.08s/it]

  1%|█▋                                                                                                                                         | 6/500 [00:12<17:03,  2.07s/it]

  1%|█▉                                                                                                                                         | 7/500 [00:14<17:00,  2.07s/it]

  2%|██▏                                                                                                                                        | 8/500 [00:16<16:57,  2.07s/it]

  2%|██▌                                                                                                                                        | 9/500 [00:18<16:45,  2.05s/it]

  2%|██▊                                                                                                                                       | 10/500 [00:20<16:40,  2.04s/it]
{'loss': 2.2101, 'grad_norm': 4.792901515960693, 'learning_rate': 2.8000000000000003e-05, 'epoch': 0.0}

  2%|███                                                                                                                                       | 11/500 [00:23<19:02,  2.34s/it]

  2%|███▎                                                                                                                                      | 12/500 [00:25<18:12,  2.24s/it]

  3%|███▌                                                                                                                                      | 13/500 [00:27<17:28,  2.15s/it]

  3%|███▊                                                                                                                                      | 14/500 [00:29<17:00,  2.10s/it]

  3%|████▏                                                                                                                                     | 15/500 [00:31<16:47,  2.08s/it]

  3%|████▍                                                                                                                                     | 16/500 [00:34<16:48,  2.08s/it]

  3%|████▋                                                                                                                                     | 17/500 [00:36<16:37,  2.07s/it]

  4%|████▉                                                                                                                                     | 18/500 [00:38<16:26,  2.05s/it]

  4%|█████▏                                                                                                                                    | 19/500 [00:40<16:16,  2.03s/it]


  4%|█████▊                                                                                                                                    | 21/500 [00:44<17:23,  2.18s/it]

  4%|██████                                                                                                                                    | 22/500 [00:46<16:57,  2.13s/it]

  5%|██████▎                                                                                                                                   | 23/500 [00:48<16:38,  2.09s/it]

  5%|██████▌                                                                                                                                   | 24/500 [00:50<16:17,  2.05s/it]

  5%|██████▉                                                                                                                                   | 25/500 [00:52<16:08,  2.04s/it]

  5%|███████▏                                                                                                                                  | 26/500 [00:54<16:01,  2.03s/it]

  5%|███████▍                                                                                                                                  | 27/500 [00:56<15:55,  2.02s/it]

  6%|███████▋                                                                                                                                  | 28/500 [00:58<15:55,  2.02s/it]

  6%|████████                                                                                                                                  | 29/500 [01:00<15:45,  2.01s/it]

  6%|████████▎                                                                                                                                 | 30/500 [01:02<15:40,  2.00s/it]

  6%|████████▌                                                                                                                                 | 31/500 [01:05<18:13,  2.33s/it]

  6%|████████▊                                                                                                                                 | 32/500 [01:07<17:22,  2.23s/it]

  7%|█████████                                                                                                                                 | 33/500 [01:09<16:48,  2.16s/it]

  7%|█████████▍                                                                                                                                | 34/500 [01:11<16:30,  2.13s/it]

  7%|█████████▋                                                                                                                                | 35/500 [01:13<16:07,  2.08s/it]

  7%|█████████▉                                                                                                                                | 36/500 [01:15<15:56,  2.06s/it]

  7%|██████████▏                                                                                                                               | 37/500 [01:17<15:43,  2.04s/it]

  8%|██████████▍                                                                                                                               | 38/500 [01:19<15:42,  2.04s/it]

  8%|██████████▊                                                                                                                               | 39/500 [01:28<31:20,  4.08s/it]

  8%|███████████                                                                                                                               | 40/500 [01:43<56:29,  7.37s/it]

  8%|███████████▏                                                                                                                            | 41/500 [01:58<1:13:49,  9.65s/it]

  8%|███████████▍                                                                                                                            | 42/500 [02:14<1:27:37, 11.48s/it]

  9%|███████████▋                                                                                                                            | 43/500 [02:30<1:37:24, 12.79s/it]

  9%|███████████▉                                                                                                                            | 44/500 [02:46<1:45:53, 13.93s/it]

  9%|████████████▏                                                                                                                           | 45/500 [03:03<1:52:26, 14.83s/it]
{'loss': 1.1508, 'grad_norm': 5.574758529663086, 'learning_rate': 9.502792575695112e-05, 'epoch': 0.0}


  9%|████████████▊                                                                                                                           | 47/500 [03:35<1:55:43, 15.33s/it]

 10%|█████████████                                                                                                                           | 48/500 [03:51<1:57:16, 15.57s/it]

 10%|█████████████▎                                                                                                                          | 49/500 [04:09<2:02:24, 16.29s/it]

 10%|█████████████▌                                                                                                                          | 50/500 [04:25<2:00:46, 16.10s/it]

 10%|█████████████▊                                                                                                                          | 51/500 [04:39<1:57:19, 15.68s/it]
 10%|█████████████▊                                                                                                                          | 51/500 [04:39<1:57:19, 15.68s/it]Traceback (most recent call last):
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 243, in <module>
    main()
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 239, in main
    trainer.train()
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\trl\trainer\sft_trainer.py", line 451, in train
    output = super().train(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 1948, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2289, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3359, in training_step
    self.accelerator.backward(loss, **kwargs)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\accelerate\accelerator.py", line 2155, in backward
    self.scaler.scale(loss).backward(**kwargs)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\autograd\__init__.py", line 289, in backward
    _engine_run_backward(
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\autograd\graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt