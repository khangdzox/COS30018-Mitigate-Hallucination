
  0%|▎                                                                                                                                | 1/500 [00:01<14:44,  1.77s/it]

  0%|▌                                                                                                                                | 2/500 [00:03<13:45,  1.66s/it]
{'loss': 2.1389, 'grad_norm': 3.158834457397461, 'learning_rate': 4e-07, 'epoch': 0.0}

  1%|▊                                                                                                                                | 3/500 [00:04<13:09,  1.59s/it]

  1%|█                                                                                                                                | 4/500 [00:06<13:06,  1.59s/it]

  1%|█▌                                                                                                                               | 6/500 [00:09<12:40,  1.54s/it]
{'loss': 2.103, 'grad_norm': 3.3733179569244385, 'learning_rate': 1.6e-06, 'epoch': 0.0}

  1%|█▊                                                                                                                               | 7/500 [00:11<12:43,  1.55s/it]

  2%|██                                                                                                                               | 8/500 [00:12<12:35,  1.53s/it]

  2%|██▌                                                                                                                             | 10/500 [00:15<12:30,  1.53s/it]

  2%|██▊                                                                                                                             | 11/500 [00:17<14:04,  1.73s/it]
{'loss': 2.2542, 'grad_norm': 3.424013376235962, 'learning_rate': 1.9838383838383834e-06, 'epoch': 0.0}

  2%|███                                                                                                                             | 12/500 [00:19<13:28,  1.66s/it]

  3%|███▎                                                                                                                            | 13/500 [00:20<13:04,  1.61s/it]

  3%|███▊                                                                                                                            | 15/500 [00:23<12:45,  1.58s/it]

  3%|████                                                                                                                            | 16/500 [00:25<12:37,  1.56s/it]
{'loss': 2.4833, 'grad_norm': 3.7832159996032715, 'learning_rate': 1.9636363636363636e-06, 'epoch': 0.0}

  3%|████▎                                                                                                                           | 17/500 [00:26<12:26,  1.55s/it]

  4%|████▊                                                                                                                           | 19/500 [00:29<12:10,  1.52s/it]

  4%|█████                                                                                                                           | 20/500 [00:31<12:14,  1.53s/it]

  4%|█████▍                                                                                                                          | 21/500 [00:33<13:36,  1.71s/it]
{'loss': 2.4583, 'grad_norm': 4.163817882537842, 'learning_rate': 1.9474747474747475e-06, 'epoch': 0.0}

  4%|█████▋                                                                                                                          | 22/500 [00:35<13:03,  1.64s/it]

  5%|█████▉                                                                                                                          | 23/500 [00:36<12:50,  1.61s/it]

  5%|██████▍                                                                                                                         | 25/500 [00:39<12:17,  1.55s/it]
{'loss': 2.0215, 'grad_norm': 5.382004261016846, 'learning_rate': 1.931313131313131e-06, 'epoch': 0.0}

  5%|██████▋                                                                                                                         | 26/500 [00:41<12:05,  1.53s/it]

  5%|██████▉                                                                                                                         | 27/500 [00:42<11:57,  1.52s/it]

  6%|███████▍                                                                                                                        | 29/500 [00:45<12:11,  1.55s/it]
{'loss': 2.2348, 'grad_norm': 4.484534740447998, 'learning_rate': 1.915151515151515e-06, 'epoch': 0.0}


  6%|███████▉                                                                                                                        | 31/500 [00:49<13:20,  1.71s/it]
{'loss': 2.3432, 'grad_norm': 5.611900329589844, 'learning_rate': 1.907070707070707e-06, 'epoch': 0.0}
  6%|███████▉                                                                                                                        | 31/500 [00:49<13:20,  1.71s/it][34m[1mwandb[39m[22m: 429 encountered (Filestream rate limit exceeded, retrying in 2.3 seconds.), retrying request
  6%|████████▏                                                                                                                       | 32/500 [00:50<12:59,  1.67s/it]

  7%|████████▍                                                                                                                       | 33/500 [00:52<12:36,  1.62s/it]

  7%|████████▋                                                                                                                       | 34/500 [00:54<13:03,  1.68s/it]

  7%|█████████▏                                                                                                                      | 36/500 [00:57<13:11,  1.71s/it]
{'loss': 2.6778, 'grad_norm': 6.736395835876465, 'learning_rate': 1.8868686868686867e-06, 'epoch': 0.0}

  7%|█████████▍                                                                                                                      | 37/500 [00:59<12:48,  1.66s/it]

  8%|█████████▋                                                                                                                      | 38/500 [01:00<12:19,  1.60s/it]

  8%|██████████▏                                                                                                                     | 40/500 [01:03<12:20,  1.61s/it]
{'loss': 2.7129, 'grad_norm': 5.638452529907227, 'learning_rate': 1.8707070707070707e-06, 'epoch': 0.0}

  8%|██████████▊                                                                                                                     | 42/500 [01:07<13:30,  1.77s/it]

  9%|███████████                                                                                                                     | 43/500 [01:09<13:07,  1.72s/it]
{'loss': 2.4619, 'grad_norm': 4.749019622802734, 'learning_rate': 1.8585858585858584e-06, 'epoch': 0.0}

  9%|███████████▎                                                                                                                    | 44/500 [01:11<13:06,  1.72s/it]


  9%|███████████▊                                                                                                                    | 46/500 [01:19<23:07,  3.06s/it]
{'loss': 2.4722, 'grad_norm': 5.494959831237793, 'learning_rate': 1.8464646464646464e-06, 'epoch': 0.0}

  9%|████████████                                                                                                                    | 47/500 [01:24<27:21,  3.62s/it]

 10%|████████████▎                                                                                                                   | 48/500 [01:26<24:20,  3.23s/it]

 10%|████████████▊                                                                                                                   | 50/500 [01:29<17:37,  2.35s/it]
{'loss': 2.7862, 'grad_norm': 6.935972690582275, 'learning_rate': 1.8303030303030303e-06, 'epoch': 0.0}

 10%|█████████████▎                                                                                                                  | 52/500 [01:33<15:25,  2.07s/it]

 11%|█████████████▌                                                                                                                  | 53/500 [01:35<14:57,  2.01s/it]

 11%|█████████████▊                                                                                                                  | 54/500 [01:37<15:16,  2.06s/it]

 11%|██████████████                                                                                                                  | 55/500 [01:39<15:01,  2.03s/it]

 11%|██████████████▎                                                                                                                 | 56/500 [01:41<15:19,  2.07s/it]

 11%|██████████████▌                                                                                                                 | 57/500 [01:43<15:02,  2.04s/it]

 12%|██████████████▊                                                                                                                 | 58/500 [01:45<14:41,  1.99s/it]

 12%|███████████████                                                                                                                 | 59/500 [01:47<14:29,  1.97s/it]

 12%|███████████████▎                                                                                                                | 60/500 [01:49<14:53,  2.03s/it]
{'loss': 2.1539, 'grad_norm': 4.381046772003174, 'learning_rate': 1.7898989898989898e-06, 'epoch': 0.0}

 12%|███████████████▌                                                                                                                | 61/500 [01:52<15:59,  2.19s/it]

 12%|███████████████▊                                                                                                                | 62/500 [01:54<16:16,  2.23s/it]

 13%|████████████████▏                                                                                                               | 63/500 [01:57<16:54,  2.32s/it]

 13%|████████████████▍                                                                                                               | 64/500 [01:59<16:02,  2.21s/it]

 13%|████████████████▋                                                                                                               | 65/500 [02:01<15:38,  2.16s/it]


 13%|█████████████████▏                                                                                                              | 67/500 [02:05<15:45,  2.18s/it]

 14%|█████████████████▍                                                                                                              | 68/500 [02:07<15:46,  2.19s/it]

 14%|█████████████████▋                                                                                                              | 69/500 [02:09<15:22,  2.14s/it]

 14%|█████████████████▉                                                                                                              | 70/500 [02:11<14:48,  2.07s/it]
{'loss': 2.2726, 'grad_norm': 3.2848641872406006, 'learning_rate': 1.7494949494949494e-06, 'epoch': 0.0}

 14%|██████████████████▍                                                                                                             | 72/500 [02:15<15:05,  2.12s/it]

 15%|██████████████████▋                                                                                                             | 73/500 [02:17<14:48,  2.08s/it]

 15%|██████████████████▉                                                                                                             | 74/500 [02:20<14:38,  2.06s/it]

 15%|███████████████████▏                                                                                                            | 75/500 [02:22<14:31,  2.05s/it]

 15%|███████████████████▍                                                                                                            | 76/500 [02:23<14:11,  2.01s/it]
{'loss': 2.5057, 'grad_norm': 4.010106086730957, 'learning_rate': 1.7252525252525252e-06, 'epoch': 0.0}

 15%|███████████████████▋                                                                                                            | 77/500 [02:26<14:51,  2.11s/it]


 16%|████████████████████▏                                                                                                           | 79/500 [02:47<47:51,  6.82s/it]
 16%|████████████████████▏                                                                                                           | 79/500 [02:47<47:51,  6.82s/it]Traceback (most recent call last):
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 244, in <module>
    main()
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 240, in main
    trainer.train()
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\trl\trainer\sft_trainer.py", line 451, in train
    output = super().train(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 1948, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2289, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3359, in training_step
    self.accelerator.backward(loss, **kwargs)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\accelerate\accelerator.py", line 2155, in backward
    self.scaler.scale(loss).backward(**kwargs)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\autograd\__init__.py", line 289, in backward
    _engine_run_backward(
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\autograd\graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt