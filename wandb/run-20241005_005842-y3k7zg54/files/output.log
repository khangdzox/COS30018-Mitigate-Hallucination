
  0%|                                                                                                                                      | 0/500 [00:00<?, ?it/s]

  0%|▎                                                                                                                             | 1/500 [00:04<33:47,  4.06s/it]


  1%|▊                                                                                                                             | 3/500 [00:11<31:51,  3.85s/it]
{'loss': 1.8445, 'grad_norm': nan, 'learning_rate': 0.0003984229402628956, 'epoch': 0.0}

  1%|█                                                                                                                             | 4/500 [00:15<31:54,  3.86s/it]

  1%|█▎                                                                                                                                   | 5/500 [00:19<31:53,  3.87s/it]

  1%|█▌                                                                                                                                   | 6/500 [00:23<31:30,  3.83s/it]

  1%|█▊                                                                                                                                   | 7/500 [00:26<31:13,  3.80s/it]

  2%|██▏                                                                                                                                  | 8/500 [00:30<31:04,  3.79s/it]

  2%|██▍                                                                                                                                  | 9/500 [00:34<31:00,  3.79s/it]

  2%|██▋                                                                                                                                 | 10/500 [00:38<31:03,  3.80s/it]

  2%|██▉                                                                                                                                 | 11/500 [00:43<33:41,  4.13s/it]

  2%|███▏                                                                                                                                | 12/500 [00:46<32:41,  4.02s/it]

  3%|███▍                                                                                                                                | 13/500 [00:50<32:08,  3.96s/it]

  3%|███▋                                                                                                                                | 14/500 [00:54<31:44,  3.92s/it]

  3%|███▉                                                                                                                                | 15/500 [00:58<31:21,  3.88s/it]

  3%|████▏                                                                                                                               | 16/500 [01:02<31:01,  3.85s/it]


  4%|████▊                                                                                                                               | 18/500 [01:09<30:44,  3.83s/it]
{'loss': 1.2896, 'grad_norm': 1.2135145664215088, 'learning_rate': 0.0003071653589957993, 'epoch': 0.0}

  4%|█████                                                                                                                               | 19/500 [01:13<30:36,  3.82s/it]

  4%|█████▎                                                                                                                              | 20/500 [01:17<30:27,  3.81s/it]

  4%|█████▌                                                                                                                              | 21/500 [01:22<32:54,  4.12s/it]


  5%|██████                                                                                                                              | 23/500 [01:29<31:28,  3.96s/it]
{'loss': 1.1762, 'grad_norm': 0.9593300819396973, 'learning_rate': 0.0002497379774329709, 'epoch': 0.0}

  5%|██████▎                                                                                                                             | 24/500 [01:33<31:01,  3.91s/it]

  5%|██████▌                                                                                                                             | 25/500 [01:37<30:45,  3.88s/it]

  5%|██████▊                                                                                                                             | 26/500 [01:41<30:32,  3.87s/it]

  5%|███████▏                                                                                                                            | 27/500 [01:44<30:21,  3.85s/it]

  6%|███████▍                                                                                                                            | 28/500 [01:48<30:06,  3.83s/it]

  6%|███████▋                                                                                                                            | 29/500 [01:52<30:02,  3.83s/it]

  6%|███████▉                                                                                                                            | 30/500 [01:56<29:54,  3.82s/it]

  6%|████████▏                                                                                                                           | 31/500 [02:00<31:12,  3.99s/it]

  6%|████████▍                                                                                                                           | 32/500 [02:04<30:39,  3.93s/it]

  7%|████████▋                                                                                                                           | 33/500 [02:08<30:19,  3.90s/it]

  7%|████████▉                                                                                                                           | 34/500 [02:12<30:06,  3.88s/it]

  7%|█████████▏                                                                                                                          | 35/500 [02:15<29:42,  3.83s/it]

  7%|█████████▌                                                                                                                          | 36/500 [02:19<29:22,  3.80s/it]

  7%|█████████▊                                                                                                                          | 37/500 [02:23<29:21,  3.80s/it]

  8%|██████████                                                                                                                          | 38/500 [02:27<29:26,  3.82s/it]

  8%|██████████▎                                                                                                                         | 39/500 [02:31<29:22,  3.82s/it]

  8%|██████████▌                                                                                                                         | 40/500 [02:34<29:06,  3.80s/it]

  8%|██████████▊                                                                                                                         | 41/500 [02:39<30:26,  3.98s/it]

  8%|███████████                                                                                                                         | 42/500 [02:43<29:56,  3.92s/it]

  9%|███████████▎                                                                                                                        | 43/500 [02:46<29:28,  3.87s/it]

  9%|███████████▌                                                                                                                        | 44/500 [02:50<29:18,  3.86s/it]

  9%|███████████▉                                                                                                                        | 45/500 [02:54<29:07,  3.84s/it]

  9%|████████████▏                                                                                                                       | 46/500 [02:58<28:57,  3.83s/it]


 10%|████████████▋                                                                                                                       | 48/500 [03:05<28:44,  3.82s/it]
{'loss': 1.2967, 'grad_norm': 1.039011001586914, 'learning_rate': 6.283367774273808e-06, 'epoch': 0.0}

 10%|████████████▉                                                                                                                       | 49/500 [03:09<28:35,  3.80s/it]


 10%|█████████████▍                                                                                                                      | 51/500 [03:17<29:52,  3.99s/it]
{'loss': 0.8886, 'grad_norm': 0.806932270526886, 'learning_rate': 3.946543143456882e-07, 'epoch': 0.0}

 10%|█████████████▋                                                                                                                      | 52/500 [03:21<29:20,  3.93s/it]

 11%|█████████████▉                                                                                                                      | 53/500 [03:25<28:57,  3.89s/it]

 11%|██████████████▎                                                                                                                     | 54/500 [03:29<28:32,  3.84s/it]

 11%|██████████████▌                                                                                                                     | 55/500 [03:32<28:20,  3.82s/it]

 11%|██████████████▊                                                                                                                     | 56/500 [03:36<28:07,  3.80s/it]

 11%|███████████████                                                                                                                     | 57/500 [03:40<28:05,  3.81s/it]

 12%|███████████████▎                                                                                                                    | 58/500 [03:44<27:52,  3.78s/it]


 12%|███████████████▊                                                                                                                    | 60/500 [03:51<27:46,  3.79s/it]
{'loss': 1.0948, 'grad_norm': 1.1809778213500977, 'learning_rate': 0.0003752613360087727, 'epoch': 0.0}


 12%|████████████████▎                                                                                                                   | 62/500 [04:00<28:31,  3.91s/it]

 13%|████████████████▋                                                                                                                   | 63/500 [04:03<28:11,  3.87s/it]
{'loss': 0.8754, 'grad_norm': 0.7649120688438416, 'learning_rate': 0.0003541026485551579, 'epoch': 0.01}

 13%|████████████████▉                                                                                                                   | 64/500 [04:07<28:03,  3.86s/it]

 13%|█████████████████▏                                                                                                                  | 65/500 [04:11<27:48,  3.84s/it]

 13%|█████████████████▍                                                                                                                  | 66/500 [04:15<27:34,  3.81s/it]

 13%|█████████████████▋                                                                                                                  | 67/500 [04:18<27:26,  3.80s/it]

 14%|█████████████████▉                                                                                                                  | 68/500 [04:22<27:31,  3.82s/it]

 14%|██████████████████▏                                                                                                                 | 69/500 [04:26<27:28,  3.83s/it]

 14%|██████████████████▍                                                                                                                 | 70/500 [04:30<27:21,  3.82s/it]

 14%|██████████████████▋                                                                                                                 | 71/500 [04:34<28:40,  4.01s/it]

 14%|███████████████████                                                                                                                 | 72/500 [04:38<28:03,  3.93s/it]

 15%|███████████████████▎                                                                                                                | 73/500 [04:42<27:31,  3.87s/it]


 15%|███████████████████▊                                                                                                                | 75/500 [04:50<27:05,  3.82s/it]
{'loss': 1.0071, 'grad_norm': 0.7822415232658386, 'learning_rate': 0.00022506664671286092, 'epoch': 0.01}

 15%|████████████████████                                                                                                                | 76/500 [04:53<26:56,  3.81s/it]

 15%|████████████████████▎                                                                                                               | 77/500 [04:57<26:44,  3.79s/it]

 16%|████████████████████▌                                                                                                               | 78/500 [05:01<26:44,  3.80s/it]

 16%|████████████████████▊                                                                                                               | 79/500 [05:05<26:33,  3.78s/it]

 16%|█████████████████████                                                                                                               | 80/500 [05:08<26:28,  3.78s/it]

 16%|█████████████████████▍                                                                                                              | 81/500 [05:13<27:42,  3.97s/it]

 16%|█████████████████████▋                                                                                                              | 82/500 [05:17<27:10,  3.90s/it]

 17%|█████████████████████▉                                                                                                              | 83/500 [05:20<26:52,  3.87s/it]

 17%|██████████████████████▏                                                                                                             | 84/500 [05:24<26:40,  3.85s/it]


 17%|██████████████████████▋                                                                                                             | 86/500 [05:32<26:15,  3.81s/it]
{'loss': 1.1132, 'grad_norm': 0.7277117967605591, 'learning_rate': 9.283464100420063e-05, 'epoch': 0.01}

 17%|██████████████████████▉                                                                                                             | 87/500 [05:35<26:08,  3.80s/it]

 18%|███████████████████████▏                                                                                                            | 88/500 [05:39<26:01,  3.79s/it]

 18%|███████████████████████▍                                                                                                            | 89/500 [05:43<26:04,  3.81s/it]

 18%|███████████████████████▊                                                                                                            | 90/500 [05:47<25:57,  3.80s/it]

 18%|████████████████████████                                                                                                            | 91/500 [05:51<27:14,  4.00s/it]

 18%|████████████████████████▎                                                                                                           | 92/500 [05:55<26:57,  3.96s/it]

 19%|████████████████████████▌                                                                                                           | 93/500 [05:59<26:30,  3.91s/it]

 19%|████████████████████████▊                                                                                                           | 94/500 [06:03<26:19,  3.89s/it]

 19%|█████████████████████████                                                                                                           | 95/500 [06:07<26:07,  3.87s/it]

 19%|█████████████████████████▎                                                                                                          | 96/500 [06:10<25:55,  3.85s/it]

 19%|█████████████████████████▌                                                                                                          | 97/500 [06:14<25:48,  3.84s/it]

 20%|█████████████████████████▊                                                                                                          | 98/500 [06:18<25:36,  3.82s/it]


 20%|██████████████████████████▏                                                                                                        | 100/500 [06:26<25:23,  3.81s/it]
{'loss': 1.1003, 'grad_norm': 0.7816386818885803, 'learning_rate': 1.577059737104447e-06, 'epoch': 0.01}

 20%|██████████████████████████▍                                                                                                        | 101/500 [06:30<26:49,  4.03s/it]

 20%|██████████████████████████▋                                                                                                        | 102/500 [06:34<26:20,  3.97s/it]


 21%|███████████████████████████▏                                                                                                       | 104/500 [06:42<25:41,  3.89s/it]
{'loss': 0.9291, 'grad_norm': 0.7266722917556763, 'learning_rate': 0.0003984229402628956, 'epoch': 0.01}

 21%|███████████████████████████▌                                                                                                       | 105/500 [06:45<25:26,  3.87s/it]

 21%|███████████████████████████▊                                                                                                       | 106/500 [06:49<25:26,  3.87s/it]

 21%|████████████████████████████                                                                                                       | 107/500 [06:53<25:07,  3.84s/it]

 22%|████████████████████████████▎                                                                                                      | 108/500 [06:57<25:01,  3.83s/it]

 22%|████████████████████████████▌                                                                                                      | 109/500 [07:01<24:53,  3.82s/it]

 22%|████████████████████████████▊                                                                                                      | 110/500 [07:04<24:47,  3.81s/it]

 22%|█████████████████████████████                                                                                                      | 111/500 [07:09<25:53,  3.99s/it]

 22%|█████████████████████████████▎                                                                                                     | 112/500 [07:13<25:20,  3.92s/it]

 23%|█████████████████████████████▌                                                                                                     | 113/500 [07:16<25:01,  3.88s/it]

 23%|█████████████████████████████▊                                                                                                     | 114/500 [07:20<24:45,  3.85s/it]


 23%|██████████████████████████████▍                                                                                                    | 116/500 [07:28<24:26,  3.82s/it]
{'loss': 0.9542, 'grad_norm': 0.9981455206871033, 'learning_rate': 0.0003274847979497378, 'epoch': 0.01}

 23%|██████████████████████████████▋                                                                                                    | 117/500 [07:32<24:13,  3.80s/it]

 24%|██████████████████████████████▉                                                                                                    | 118/500 [07:35<24:07,  3.79s/it]

 24%|███████████████████████████████▏                                                                                                   | 119/500 [07:39<24:04,  3.79s/it]

 24%|███████████████████████████████▍                                                                                                   | 120/500 [07:43<24:10,  3.82s/it]

 24%|███████████████████████████████▋                                                                                                   | 121/500 [07:47<25:07,  3.98s/it]

 24%|███████████████████████████████▉                                                                                                   | 122/500 [07:51<24:37,  3.91s/it]

 25%|████████████████████████████████▏                                                                                                  | 123/500 [07:55<24:17,  3.87s/it]

 25%|████████████████████████████████▍                                                                                                  | 124/500 [07:59<24:00,  3.83s/it]

 25%|████████████████████████████████▊                                                                                                  | 125/500 [08:02<23:54,  3.83s/it]

 25%|█████████████████████████████████                                                                                                  | 126/500 [08:06<23:37,  3.79s/it]


 26%|█████████████████████████████████▌                                                                                                 | 128/500 [08:14<23:30,  3.79s/it]
{'loss': 1.0397, 'grad_norm': 0.7193039059638977, 'learning_rate': 0.00018744189609413734, 'epoch': 0.01}

 26%|█████████████████████████████████▊                                                                                                 | 129/500 [08:17<23:25,  3.79s/it]


 26%|██████████████████████████████████▎                                                                                                | 131/500 [08:26<24:26,  3.97s/it]
{'loss': 0.8794, 'grad_norm': 0.6456049680709839, 'learning_rate': 0.00015026202256702905, 'epoch': 0.01}

 26%|██████████████████████████████████▌                                                                                                | 132/500 [08:29<23:58,  3.91s/it]

 27%|██████████████████████████████████▊                                                                                                | 133/500 [08:33<23:40,  3.87s/it]

 27%|███████████████████████████████████                                                                                                | 134/500 [08:37<23:22,  3.83s/it]

 27%|███████████████████████████████████▎                                                                                               | 135/500 [08:41<23:09,  3.81s/it]

 27%|███████████████████████████████████▋                                                                                               | 136/500 [08:45<23:10,  3.82s/it]

 27%|███████████████████████████████████▉                                                                                               | 137/500 [08:48<23:01,  3.81s/it]


 28%|████████████████████████████████████▍                                                                                              | 139/500 [08:56<22:50,  3.80s/it]

 28%|████████████████████████████████████▋                                                                                              | 140/500 [09:00<22:49,  3.80s/it]
{'loss': 0.9461, 'grad_norm': 0.7549188137054443, 'learning_rate': 5.42062745157176e-05, 'epoch': 0.01}

 28%|████████████████████████████████████▉                                                                                              | 141/500 [09:04<23:58,  4.01s/it]


 29%|█████████████████████████████████████▍                                                                                             | 143/500 [09:12<23:09,  3.89s/it]
{'loss': 1.0873, 'grad_norm': 0.739059567451477, 'learning_rate': 3.113441489959703e-05, 'epoch': 0.01}

 29%|█████████████████████████████████████▋                                                                                             | 144/500 [09:16<22:55,  3.86s/it]

 29%|█████████████████████████████████████▉                                                                                             | 145/500 [09:19<22:38,  3.83s/it]

 29%|██████████████████████████████████████▎                                                                                            | 146/500 [09:23<22:25,  3.80s/it]

 29%|██████████████████████████████████████▌                                                                                            | 147/500 [09:27<22:19,  3.79s/it]

 30%|██████████████████████████████████████▊                                                                                            | 148/500 [09:31<22:19,  3.81s/it]

 30%|███████████████████████████████████████                                                                                            | 149/500 [09:34<22:09,  3.79s/it]

 30%|███████████████████████████████████████▎                                                                                           | 150/500 [09:38<22:07,  3.79s/it]

 30%|███████████████████████████████████████▌                                                                                           | 151/500 [09:43<23:24,  4.02s/it]

 30%|███████████████████████████████████████▊                                                                                           | 152/500 [09:47<23:00,  3.97s/it]

 31%|████████████████████████████████████████                                                                                           | 153/500 [09:50<22:42,  3.93s/it]

 31%|████████████████████████████████████████▎                                                                                          | 154/500 [09:54<22:25,  3.89s/it]


 31%|████████████████████████████████████████▊                                                                                          | 156/500 [10:02<21:58,  3.83s/it]
{'loss': 1.1215, 'grad_norm': 0.9321266412734985, 'learning_rate': 0.0003937166322257262, 'epoch': 0.01}

 31%|█████████████████████████████████████████▏                                                                                         | 157/500 [10:06<21:47,  3.81s/it]

 32%|█████████████████████████████████████████▍                                                                                         | 158/500 [10:09<21:43,  3.81s/it]

 32%|█████████████████████████████████████████▋                                                                                         | 159/500 [10:13<21:38,  3.81s/it]

 32%|█████████████████████████████████████████▉                                                                                         | 160/500 [10:17<21:35,  3.81s/it]

 32%|██████████████████████████████████████████▏                                                                                        | 161/500 [10:21<22:38,  4.01s/it]

 32%|██████████████████████████████████████████▍                                                                                        | 162/500 [10:25<22:13,  3.94s/it]

 33%|██████████████████████████████████████████▋                                                                                        | 163/500 [10:29<21:55,  3.90s/it]

 33%|██████████████████████████████████████████▉                                                                                        | 164/500 [10:33<21:37,  3.86s/it]

 33%|███████████████████████████████████████████▏                                                                                       | 165/500 [10:37<21:22,  3.83s/it]

 33%|███████████████████████████████████████████▍                                                                                       | 166/500 [10:40<21:18,  3.83s/it]


 34%|████████████████████████████████████████████                                                                                       | 168/500 [10:48<21:09,  3.82s/it]

 34%|████████████████████████████████████████████▎                                                                                      | 169/500 [10:52<21:05,  3.82s/it]
{'loss': 1.0948, 'grad_norm': 0.6463798880577087, 'learning_rate': 0.00029635073482034294, 'epoch': 0.01}

 34%|████████████████████████████████████████████▌                                                                                      | 170/500 [10:56<21:03,  3.83s/it]

 34%|████████████████████████████████████████████▊                                                                                      | 171/500 [11:00<21:55,  4.00s/it]

 34%|█████████████████████████████████████████████                                                                                      | 172/500 [11:04<21:33,  3.94s/it]

 35%|█████████████████████████████████████████████▎                                                                                     | 173/500 [11:08<21:18,  3.91s/it]

 35%|█████████████████████████████████████████████▌                                                                                     | 174/500 [11:12<21:09,  3.89s/it]

 35%|█████████████████████████████████████████████▊                                                                                     | 175/500 [11:15<21:08,  3.90s/it]

 35%|██████████████████████████████████████████████                                                                                     | 176/500 [11:19<20:54,  3.87s/it]

 35%|██████████████████████████████████████████████▎                                                                                    | 177/500 [11:23<20:48,  3.86s/it]

 36%|██████████████████████████████████████████████▋                                                                                    | 178/500 [11:27<20:56,  3.90s/it]

 36%|██████████████████████████████████████████████▉                                                                                    | 179/500 [11:31<21:02,  3.93s/it]

 36%|███████████████████████████████████████████████▏                                                                                   | 180/500 [11:35<21:00,  3.94s/it]

 36%|███████████████████████████████████████████████▍                                                                                   | 181/500 [11:40<22:59,  4.33s/it]

 36%|███████████████████████████████████████████████▋                                                                                   | 182/500 [11:44<22:17,  4.21s/it]

 37%|███████████████████████████████████████████████▉                                                                                   | 183/500 [11:48<21:40,  4.10s/it]

 37%|████████████████████████████████████████████████▏                                                                                  | 184/500 [11:52<21:16,  4.04s/it]

 37%|████████████████████████████████████████████████▍                                                                                  | 185/500 [11:56<21:05,  4.02s/it]

 37%|████████████████████████████████████████████████▋                                                                                  | 186/500 [12:00<20:52,  3.99s/it]

 37%|████████████████████████████████████████████████▉                                                                                  | 187/500 [12:04<20:42,  3.97s/it]

 38%|█████████████████████████████████████████████████▎                                                                                 | 188/500 [12:08<20:36,  3.96s/it]

 38%|█████████████████████████████████████████████████▌                                                                                 | 189/500 [12:12<20:18,  3.92s/it]

 38%|█████████████████████████████████████████████████▊                                                                                 | 190/500 [12:15<20:01,  3.88s/it]

 38%|██████████████████████████████████████████████████                                                                                 | 191/500 [12:20<20:44,  4.03s/it]

 38%|██████████████████████████████████████████████████▎                                                                                | 192/500 [12:24<20:19,  3.96s/it]

 39%|██████████████████████████████████████████████████▌                                                                                | 193/500 [12:27<20:15,  3.96s/it]Traceback (most recent call last):
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 242, in <module>
    main()
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 238, in main
    trainer.train()
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\trl\trainer\sft_trainer.py", line 451, in train
    output = super().train(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 1948, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2289, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3359, in training_step
    self.accelerator.backward(loss, **kwargs)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\accelerate\accelerator.py", line 2155, in backward
    self.scaler.scale(loss).backward(**kwargs)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\autograd\__init__.py", line 289, in backward
    _engine_run_backward(
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\torch\autograd\graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt