
  0%|▎                                                                                                                                          | 1/500 [00:01<13:33,  1.63s/it]
{'loss': 2.2091, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 0.0}

  1%|▊                                                                                                                                          | 3/500 [00:03<09:25,  1.14s/it]
{'loss': 2.2944, 'grad_norm': nan, 'learning_rate': 0.0, 'epoch': 0.0}

  1%|█▍                                                                                                                                         | 5/500 [00:05<08:48,  1.07s/it]
{'loss': 2.0814, 'grad_norm': 4.881211280822754, 'learning_rate': 4e-05, 'epoch': 0.0}

  1%|█▉                                                                                                                                         | 7/500 [00:07<08:32,  1.04s/it]
{'loss': 2.5187, 'grad_norm': 4.487595558166504, 'learning_rate': 8e-05, 'epoch': 0.0}

  2%|██▌                                                                                                                                        | 9/500 [00:09<08:05,  1.01it/s]
{'loss': 2.2817, 'grad_norm': nan, 'learning_rate': 0.0001, 'epoch': 0.0}

  2%|██▊                                                                                                                                       | 10/500 [00:10<08:12,  1.01s/it]

  2%|███▎                                                                                                                                      | 12/500 [00:13<09:11,  1.13s/it]
{'loss': 2.062, 'grad_norm': 5.513221263885498, 'learning_rate': 9.942108874226811e-05, 'epoch': 0.0}

  3%|███▊                                                                                                                                      | 14/500 [00:15<08:48,  1.09s/it]
{'loss': 1.647, 'grad_norm': 5.1630048751831055, 'learning_rate': 9.839743506981782e-05, 'epoch': 0.0}

  3%|████▍                                                                                                                                     | 16/500 [00:17<08:34,  1.06s/it]
{'loss': 1.9165, 'grad_norm': 5.92342472076416, 'learning_rate': 9.687515136252731e-05, 'epoch': 0.0}

  4%|████▉                                                                                                                                     | 18/500 [00:19<08:16,  1.03s/it]
{'loss': 1.5199, 'grad_norm': 7.418619632720947, 'learning_rate': 9.486992143456792e-05, 'epoch': 0.0}

  4%|█████▌                                                                                                                                    | 20/500 [00:21<08:12,  1.03s/it]
{'loss': 1.4009, 'grad_norm': 10.317620277404785, 'learning_rate': 9.24024048078213e-05, 'epoch': 0.0}
{'loss': 1.2987, 'grad_norm': 9.370467185974121, 'learning_rate': 9.100305426420956e-05, 'epoch': 0.0}

  4%|██████                                                                                                                                    | 22/500 [00:24<10:31,  1.32s/it]
{'loss': 1.4621, 'grad_norm': 9.22046184539795, 'learning_rate': 8.789119261039385e-05, 'epoch': 0.0}

  5%|██████▌                                                                                                                                   | 24/500 [00:26<09:08,  1.15s/it]
{'loss': 1.5927, 'grad_norm': 8.324612617492676, 'learning_rate': 8.438894484078086e-05, 'epoch': 0.0}

  5%|███████▏                                                                                                                                  | 26/500 [00:29<08:50,  1.12s/it]

  6%|███████▋                                                                                                                                  | 28/500 [00:31<08:34,  1.09s/it]
{'loss': 1.4318, 'grad_norm': 9.001758575439453, 'learning_rate': 7.848353992861195e-05, 'epoch': 0.0}

  6%|████████▎                                                                                                                                 | 30/500 [00:33<08:27,  1.08s/it]

  6%|████████▌                                                                                                                                 | 31/500 [00:35<10:07,  1.29s/it]
{'loss': 1.6713, 'grad_norm': 12.205146789550781, 'learning_rate': 7.191855733945387e-05, 'epoch': 0.0}

  7%|█████████                                                                                                                                 | 33/500 [00:37<08:56,  1.15s/it]
{'loss': 1.4868, 'grad_norm': 6.459771156311035, 'learning_rate': 6.725001835974853e-05, 'epoch': 0.0}

  7%|█████████▋                                                                                                                                | 35/500 [00:39<08:18,  1.07s/it]
{'loss': 1.4894, 'grad_norm': 7.205861568450928, 'learning_rate': 6.240375555556145e-05, 'epoch': 0.0}

  7%|██████████▏                                                                                                                               | 37/500 [00:41<08:09,  1.06s/it]
{'loss': 1.0569, 'grad_norm': 5.889032363891602, 'learning_rate': 5.7429699097518585e-05, 'epoch': 0.0}

  8%|██████████▊                                                                                                                               | 39/500 [00:43<07:51,  1.02s/it]
{'loss': 1.3551, 'grad_norm': 6.9753642082214355, 'learning_rate': 5.2379095791187124e-05, 'epoch': 0.0}

  8%|███████████▎                                                                                                                              | 41/500 [00:45<09:02,  1.18s/it]
{'loss': 1.1103, 'grad_norm': 6.456303119659424, 'learning_rate': 4.730398109049071e-05, 'epoch': 0.0}

  9%|███████████▊                                                                                                                              | 43/500 [00:47<08:22,  1.10s/it]
{'loss': 1.3509, 'grad_norm': 5.144263744354248, 'learning_rate': 4.2256642985823395e-05, 'epoch': 0.0}

  9%|████████████▍                                                                                                                             | 45/500 [00:49<08:05,  1.07s/it]
{'loss': 1.5479, 'grad_norm': 6.256798267364502, 'learning_rate': 3.728908329032567e-05, 'epoch': 0.0}

  9%|████████████▋                                                                                                                             | 46/500 [00:50<07:54,  1.05s/it]
{'loss': 1.6562, 'grad_norm': 5.370774745941162, 'learning_rate': 3.2452481874593234e-05, 'epoch': 0.0}

 10%|█████████████▏                                                                                                                            | 48/500 [00:53<07:54,  1.05s/it]
{'loss': 0.8805, 'grad_norm': 9.726933479309082, 'learning_rate': 2.7796669369711294e-05, 'epoch': 0.0}

 10%|█████████████▊                                                                                                                            | 50/500 [00:54<07:35,  1.01s/it]

 10%|██████████████▎                                                                                                                           | 52/500 [00:57<08:31,  1.14s/it]
{'loss': 1.2355, 'grad_norm': 7.715084552764893, 'learning_rate': 2.125622839894964e-05, 'epoch': 0.0}

 11%|██████████████▉                                                                                                                           | 54/500 [00:59<07:54,  1.06s/it]
{'loss': 1.0638, 'grad_norm': 7.6016740798950195, 'learning_rate': 1.725696330273575e-05, 'epoch': 0.0}

 11%|███████████████▍                                                                                                                          | 56/500 [01:01<07:44,  1.05s/it]
{'loss': 1.3869, 'grad_norm': 5.570895671844482, 'learning_rate': 1.3595043801501794e-05, 'epoch': 0.0}

 12%|████████████████                                                                                                                          | 58/500 [01:03<07:32,  1.02s/it]
{'loss': 1.1477, 'grad_norm': 5.298169136047363, 'learning_rate': 1.0308197990669538e-05, 'epoch': 0.0}

 12%|████████████████▌                                                                                                                         | 60/500 [01:05<07:25,  1.01s/it]
 12%|████████████████▌                                                                                                                         | 60/500 [01:05<07:25,  1.01s/it]Traceback (most recent call last):
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 243, in <module>
    main()
  File "c:\Users\pink\Documents\Study\Intelligent Systems\COS30018-Mitigate-Hallucination\Finetuning\LLAMA3_QLoRA.py", line 239, in main
    trainer.train()
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\trl\trainer\sft_trainer.py", line 451, in train
    output = super().train(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 1948, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2366, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, grad_norm, model, trial, epoch, ignore_keys_for_eval)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2817, in _maybe_log_save_evaluate
    self._save_checkpoint(model, trial, metrics=metrics)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 2896, in _save_checkpoint
    self.save_model(output_dir, _internal_call=True)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3464, in save_model
    self._save(output_dir)
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\transformers\trainer.py", line 3535, in _save
    self.model.save_pretrained(
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\peft\peft_model.py", line 343, in save_pretrained
    safe_save_file(
  File "C:\Users\pink\anaconda3\envs\LLama3-hallucinate\Lib\site-packages\safetensors\torch.py", line 286, in save_file
    serialize_file(_flatten(tensors), filename, metadata=metadata)
safetensors_rust.SafetensorError: Error while serializing: IoError(Os { code: 1224, kind: Uncategorized, message: "The requested operation cannot be performed on a file with a user-mapped section open." })